<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.flowable.org/processdef">
  <process id="if-needed-xs2a-oauth2-step" name="if-needed-xs2a-oauth2-step" isExecutable="true">
    <documentation>Xs2a Oauth2 pre-step that allows bypass if not needed</documentation>
    <startEvent id="sid-00cfc121-44b4-41b7-93fe-d90e3e9ab50f"/>
    <endEvent id="sid-e0dbf285-c6c2-4571-ac5e-9038fcbf8448"/>
    <sequenceFlow id="sid-c2566b77-4973-4caf-b125-70ec5b9eb85a" sourceRef="sid-00cfc121-44b4-41b7-93fe-d90e3e9ab50f" targetRef="sid-ef5a15f0-fbfd-48ac-b35a-f64d250e0f9d"/>
    <exclusiveGateway id="sid-ef5a15f0-fbfd-48ac-b35a-f64d250e0f9d" default="oauth2FlowNotRequired"/>
    <serviceTask id="sid-1adf2519-4ebf-411a-b0d7-9ed126bdcf28" flowable:exclusive="true" flowable:expression="1+1"/>
    <sequenceFlow id="oauth2FlowNotRequired" sourceRef="sid-ef5a15f0-fbfd-48ac-b35a-f64d250e0f9d" targetRef="sid-e0dbf285-c6c2-4571-ac5e-9038fcbf8448" name="Oauth2 not required">
      <conditionExpression xsi:type="tFormalExpression"/>
    </sequenceFlow>
    <serviceTask id="sid-137d03a1-a1b7-4a0a-9b5e-3be59e6feac7" flowable:exclusive="true" flowable:expression="1+1"/>
    <sequenceFlow id="oauth2AuthorizationRequired" sourceRef="sid-ef5a15f0-fbfd-48ac-b35a-f64d250e0f9d" targetRef="sid-137d03a1-a1b7-4a0a-9b5e-3be59e6feac7" name="Oauth2 Authorization required">
      <conditionExpression xsi:type="tFormalExpression">#{xs2aConsentInfo.isOauth2Authorization(CONTEXT)}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="oauth2AuthenticationRequired" sourceRef="sid-ef5a15f0-fbfd-48ac-b35a-f64d250e0f9d" targetRef="sid-1adf2519-4ebf-411a-b0d7-9ed126bdcf28" name="Oauth2 Authentication (pre-step) required">
      <conditionExpression xsi:type="tFormalExpression">#{xs2aConsentInfo.isOauth2AuthenticationPreStep(CONTEXT)}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-aa5c802b-92ba-4f55-b69c-6513491102e2" sourceRef="sid-137d03a1-a1b7-4a0a-9b5e-3be59e6feac7" targetRef="sid-e0dbf285-c6c2-4571-ac5e-9038fcbf8448"/>
    <sequenceFlow id="sid-e030f649-cb5b-4b10-bcd3-edb973529961" sourceRef="sid-1adf2519-4ebf-411a-b0d7-9ed126bdcf28" targetRef="sid-e0dbf285-c6c2-4571-ac5e-9038fcbf8448"/>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_xs2a-oauth2-step">
    <bpmndi:BPMNPlane bpmnElement="if-needed-xs2a-oauth2-step" id="BPMNPlane_xs2a-oauth2-step">
      <bpmdi:BPMNShape xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="shape-e9bbaf6b-a61e-419f-a838-ce9912aae0d0" bpmnElement="sid-00cfc121-44b4-41b7-93fe-d90e3e9ab50f">
        <omgdc:Bounds x="136.0" y="249.0" width="30.0" height="30.0"/>
      </bpmdi:BPMNShape>
      <bpmdi:BPMNShape xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="shape-890f6be9-ffbe-4920-9e3e-baa594979f69" bpmnElement="sid-e0dbf285-c6c2-4571-ac5e-9038fcbf8448">
        <omgdc:Bounds x="764.0" y="249.0" width="30.0" height="30.0"/>
      </bpmdi:BPMNShape>
      <bpmdi:BPMNEdge xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="edge-e569f6dd-959e-4bf0-972d-cf2a541b0811" bpmnElement="sid-c2566b77-4973-4caf-b125-70ec5b9eb85a">
        <omgdi:waypoint x="166.0" y="264.0"/>
        <omgdi:waypoint x="237.35999" y="264.0"/>
      </bpmdi:BPMNEdge>
      <bpmdi:BPMNShape xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="shape-922743df-3288-45d5-bdcd-29dca6114518" bpmnElement="sid-ef5a15f0-fbfd-48ac-b35a-f64d250e0f9d">
        <omgdc:Bounds x="237.36002" y="244.0" width="40.0" height="40.0"/>
      </bpmdi:BPMNShape>
      <bpmdi:BPMNShape xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="shape-f44c8b49-359c-48c3-af2f-d36382e9c942" bpmnElement="sid-1adf2519-4ebf-411a-b0d7-9ed126bdcf28">
        <omgdc:Bounds x="427.36002" y="50.0" width="100.0" height="80.0"/>
      </bpmdi:BPMNShape>
      <bpmdi:BPMNEdge xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="edge-2115e705-19bf-4fbc-865c-b135d3740346" bpmnElement="oauth2FlowNotRequired">
        <omgdi:waypoint x="257.36002" y="284.0"/>
        <omgdi:waypoint x="257.36002" y="367.25"/>
        <omgdi:waypoint x="779.0" y="367.25"/>
        <omgdi:waypoint x="779.00006" y="279.00003"/>
      </bpmdi:BPMNEdge>
      <bpmdi:BPMNShape xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="sid-db67e282-07d2-40b9-a6b9-209f52adf46e" bpmnElement="sid-137d03a1-a1b7-4a0a-9b5e-3be59e6feac7">
        <omgdc:Bounds x="427.36" y="224.0" width="100.0" height="80.0"/>
      </bpmdi:BPMNShape>
      <bpmdi:BPMNEdge xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="edge-b71ef73e-00a3-4644-ba62-67628ac98216" bpmnElement="oauth2AuthorizationRequired">
        <omgdi:waypoint x="277.36002" y="264.0"/>
        <omgdi:waypoint x="427.36" y="264.0"/>
      </bpmdi:BPMNEdge>
      <bpmdi:BPMNEdge xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="edge-8175f9a9-e235-4ae8-8c5e-74b9c1197097" bpmnElement="oauth2AuthenticationRequired">
        <omgdi:waypoint x="257.36002" y="244.0"/>
        <omgdi:waypoint x="257.36002" y="90.00001"/>
        <omgdi:waypoint x="427.36002" y="90.0"/>
      </bpmdi:BPMNEdge>
      <bpmdi:BPMNEdge xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="edge-5da80b65-b0e9-4dcc-9e2d-2388b8cad3e1" bpmnElement="sid-aa5c802b-92ba-4f55-b69c-6513491102e2">
        <omgdi:waypoint x="527.36" y="264.0"/>
        <omgdi:waypoint x="764.0" y="264.0"/>
      </bpmdi:BPMNEdge>
      <bpmdi:BPMNEdge xmlns:bpmdi="http://www.omg.org/spec/BPMN/20100524/DI" id="edge-0a8c33f3-4054-4560-84ca-73132f2657d1" bpmnElement="sid-e030f649-cb5b-4b10-bcd3-edb973529961">
        <omgdi:waypoint x="527.36" y="90.0"/>
        <omgdi:waypoint x="779.00006" y="90.00001"/>
        <omgdi:waypoint x="779.0" y="249.0"/>
      </bpmdi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
