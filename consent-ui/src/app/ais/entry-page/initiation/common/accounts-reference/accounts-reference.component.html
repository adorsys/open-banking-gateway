<form [formGroup]="targetForm">
  <ng-container *ngFor="let account of accounts">
    <div
      class="form-inline"
      [ngClass]="{
        'is-invalid': targetForm.controls[account.ibanId].touched && targetForm.controls[account.ibanId].errors
      }"
    >
      <input
        type="text"
        [id]="account.ibanId"
        [name]="account.ibanId"
        [formControlName]="account.ibanId"
        placeholder="IBAN"
        [ngClass]="{
          'is-invalid': targetForm.controls[account.ibanId].touched && targetForm.controls[account.ibanId].errors
        }"
        class="form-control"
      />
      <select
        type="text"
        [id]="account.currencyId"
        [name]="account.currencyId"
        [formControlName]="account.currencyId"
        class="form-control currencySelector"
      >
        <option>EUR</option>
        <option>GBP</option>
        <option>USD</option>
      </select>
      <button
        type="button"
        class="btn btn-link pointer pl-2"
        (click)="removeAccount(account)"
        (keyup.enter)="removeAccount(account)"
        aria-label="Remove account"
      >
        <img ngSrc="assets/icons/minus.png" alt="Remove" height="24" width="24" />
      </button>
    </div>
    <div
      class="invalid-feedback mb-2"
      *ngIf="targetForm.controls[account.ibanId].touched && targetForm.controls[account.ibanId].errors; else noErrors"
    >
      Please enter a valid IBAN
    </div>
    <ng-template #noErrors>
      <br />
    </ng-template>
  </ng-container>
</form>

<button
  type="button"
  class="btn btn-link pointer"
  (click)="addAccount()"
  (keyup.enter)="addAccount()"
  aria-label="Add account"
>
  <img ngSrc="assets/icons/plus.png" alt="Add" height="24" width="24" /> Add account
</button>
