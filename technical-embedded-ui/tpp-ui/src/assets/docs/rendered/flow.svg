<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="4879px" preserveAspectRatio="none" style="width:3884px;height:4879px;" version="1.1" viewBox="0 0 3884 4879" width="3884px" zoomAndPan="magnify"><defs><filter height="300%" id="fmw2wna09i7on" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="4772.4531" style="stroke: #A80036; stroke-width: 1.0;" width="951.5" x="775.5" y="96.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="1224.75" y="108.2544">TPP API</text><rect fill="#DDDDDD" height="4772.4531" style="stroke: #A80036; stroke-width: 1.0;" width="875" x="1729" y="96.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="2120.5" y="108.2544">OPBA-Facade</text><rect fill="#DDDDDD" height="4772.4531" style="stroke: #A80036; stroke-width: 1.0;" width="1206.5" x="2606" y="96.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="3159.75" y="108.2544">XS2A-Protocol</text><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="2562.6953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="229" y="1256.3984"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="886.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="267.8828"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="1432.9141" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="1367.9297"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="801.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="2945.375"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="857.8516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="3906.4922"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="828.7188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="866" y="297.0156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="799.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="866" y="3935.625"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="2320.6328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1051.5" y="1397.0625"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="609.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1056.5" y="2162.5156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="713.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1056.5" y="3004.5078"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="1067.4688"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="2191.6484"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="2713.4453"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="3659.4297"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="4676.9453"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="712.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="326.1484"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="1258.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="1426.1953"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="596.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="3033.6406"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="683.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="3964.7578"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="442.6797"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="631.4766"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="892.6719"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="950.9375"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="1542.7266"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="1600.9922"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="1789.7891"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="2075.1172"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="3150.1719"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="3208.4375"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="3412.3672"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="4081.2891"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="4270.0859"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="355.2813"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="1455.3281"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="3062.7734"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="3993.8906"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="413.5469"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="1513.5938"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="3121.0391"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="4052.1563"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="530.0781"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="1688.3906"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="3295.8359"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="4168.6875"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="863.5391"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="2045.9844"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="2626.0469"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="3587.1641"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="4589.5469"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="246.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="588.3438"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="270.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="1746.6563"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="117.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="2479.5156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="333.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="4226.9531"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3092" y="3354.1016"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3281" y="4473.0156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="144.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="602.3438"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="168.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="1760.6563"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="178.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="2330.9844"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="3383.2344"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="532.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="4240.9531"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="776.1406"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="1958.5859"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="2538.6484"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="3499.7656"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="4443.8828"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3838" y="2421.25"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="102.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3838" y="2873.1094"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3838" y="4385.6172"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="1036.4531" style="stroke: #000000; stroke-width: 2.0;" width="3632.5" x="196" y="1314.5313"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="510.0625" style="stroke: #000000; stroke-width: 2.0;" width="3612.5" x="206" y="1833.9219"/><rect fill="#FFFFFF" height="56.9375" style="stroke: none; stroke-width: 1.0;" width="3612.5" x="206" y="2287.0469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="36" x2="36" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="234" x2="234" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="658" x2="658" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="870.5" x2="870.5" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1056.5" x2="1056.5" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1634" x2="1634" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1791" x2="1791" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1893" x2="1893" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2041.5" x2="2041.5" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2301" x2="2301" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2401" x2="2401" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2520" x2="2520" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2708" x2="2708" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2908" x2="2908" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3097" x2="3097" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3286" x2="3286" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3441" x2="3441" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3744.5" x2="3744.5" y1="178.4844" y2="4782.3438"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3842.5" x2="3842.5" y1="178.4844" y2="4782.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="8" y="175.1826">FinTech</text><ellipse cx="36" cy="105.1875" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M36,113.1875 L36,140.1875 M23,121.1875 L49,121.1875 M36,140.1875 L23,155.1875 M36,140.1875 L49,155.1875 " fill="none" filter="url(#fmw2wna09i7on)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="8" y="4794.3389">FinTech</text><ellipse cx="36" cy="4807.6406" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M36,4815.6406 L36,4842.6406 M23,4823.6406 L49,4823.6406 M36,4842.6406 L23,4857.6406 M36,4842.6406 L49,4857.6406 " fill="none" filter="url(#fmw2wna09i7on)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="216" y="175.1826">User</text><ellipse cx="234" cy="105.1875" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M234,113.1875 L234,140.1875 M221,121.1875 L247,121.1875 M234,140.1875 L221,155.1875 M234,140.1875 L247,155.1875 " fill="none" filter="url(#fmw2wna09i7on)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="216" y="4794.3389">User</text><ellipse cx="234" cy="4807.6406" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M234,4815.6406 L234,4842.6406 M221,4823.6406 L247,4823.6406 M234,4842.6406 L221,4857.6406 M234,4842.6406 L247,4857.6406 " fill="none" filter="url(#fmw2wna09i7on)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="611" y="139.1875"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="607" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="614" y="163.1826">TppBackend</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="611" y="4781.3438"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="607" y="4785.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="614" y="4805.3389">TppBackend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="177" x="779.5" y="175.1826">TppBankingApiAisController</text><ellipse cx="871" cy="146.1875" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="867,134.1875,873,129.1875,871,134.1875,873,139.1875,867,134.1875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="177" x="779.5" y="4794.3389">TppBankingApiAisController</text><ellipse cx="871" cy="4813.6406" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="867,4801.6406,873,4796.6406,871,4801.6406,873,4806.6406,867,4801.6406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="972.5" y="175.1826">ConsentServiceController</text><ellipse cx="1056.5" cy="146.1875" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1052.5,134.1875,1058.5,129.1875,1056.5,134.1875,1058.5,139.1875,1052.5,134.1875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="972.5" y="4794.3389">ConsentServiceController</text><ellipse cx="1056.5" cy="4813.6406" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1052.5,4801.6406,1058.5,4796.6406,1056.5,4801.6406,1058.5,4806.6406,1052.5,4801.6406" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="1546" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="1553" y="163.1826">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="1546" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="1553" y="4801.3389">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1737" y="139.1875"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1733" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1740" y="163.1826">FacadeService</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1737" y="4781.3438"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1733" y="4785.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1740" y="4805.3389">FacadeService</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1859" y="175.1826">Database</text><path d="M1875,126.1875 C1875,116.1875 1893,116.1875 1893,116.1875 C1893,116.1875 1911,116.1875 1911,126.1875 L1911,152.1875 C1911,162.1875 1893,162.1875 1893,162.1875 C1893,162.1875 1875,162.1875 1875,152.1875 L1875,126.1875 " fill="#FEFECE" filter="url(#fmw2wna09i7on)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1875,126.1875 C1875,136.1875 1893,136.1875 1893,136.1875 C1893,136.1875 1911,136.1875 1911,126.1875 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1859" y="4794.3389">Database</text><path d="M1875,4807.6406 C1875,4797.6406 1893,4797.6406 1893,4797.6406 C1893,4797.6406 1911,4797.6406 1911,4807.6406 L1911,4833.6406 C1911,4843.6406 1893,4843.6406 1893,4843.6406 C1893,4843.6406 1875,4843.6406 1875,4833.6406 L1875,4807.6406 " fill="#FEFECE" filter="url(#fmw2wna09i7on)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1875,4807.6406 C1875,4817.6406 1893,4817.6406 1893,4817.6406 C1893,4817.6406 1911,4817.6406 1911,4807.6406 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="1957.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="1964.5" y="163.1826">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="1957.5" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="1964.5" y="4801.3389">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="2240" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="2247" y="163.1826">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="2240" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="2247" y="4801.3389">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="2372" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="2379" y="163.1826">Spring</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="2372" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="2379" y="4801.3389">Spring</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="2440" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="142" x="2447" y="163.1826">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="2440" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="142" x="2447" y="4801.3389">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="2610" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="2617" y="163.1826">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="2610" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="2617" y="4801.3389">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="2817" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="2824" y="163.1826">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="2817" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="2824" y="4801.3389">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="3009" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="3016" y="163.1826">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="3009" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="3016" y="4801.3389">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="3195" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="3202" y="163.1826">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="3195" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="3202" y="4801.3389">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="3391" y="139.1875"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="3387" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="3394" y="163.1826">Xs2aServices</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="3391" y="4781.3438"/><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="3387" y="4785.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="3394" y="4805.3389">Xs2aServices</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="3681.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="3688.5" y="163.1826">OutcomeMapper</text><rect fill="#FEFECE" filter="url(#fmw2wna09i7on)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="3681.5" y="4781.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="3688.5" y="4801.3389">OutcomeMapper</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="3819.5" y="175.1826">ASPSP</text><path d="M3822.5,134.1875 L3822.5,158.1875 M3822.5,146.1875 L3839.5,146.1875 " fill="none" filter="url(#fmw2wna09i7on)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3851.5" cy="146.1875" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="3819.5" y="4794.3389">ASPSP</text><path d="M3822.5,4801.6406 L3822.5,4825.6406 M3822.5,4813.6406 L3839.5,4813.6406 " fill="none" filter="url(#fmw2wna09i7on)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3851.5" cy="4813.6406" fill="#FEFECE" filter="url(#fmw2wna09i7on)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="2562.6953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="229" y="1256.3984"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="886.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="267.8828"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="1432.9141" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="1367.9297"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="801.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="2945.375"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="857.8516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="3906.4922"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="828.7188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="866" y="297.0156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="799.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="866" y="3935.625"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="2320.6328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1051.5" y="1397.0625"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="609.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1056.5" y="2162.5156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="713.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1056.5" y="3004.5078"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="1067.4688"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="2191.6484"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="2713.4453"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="3659.4297"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1629.5" y="4676.9453"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="712.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="326.1484"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="1258.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="1426.1953"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="596.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="3033.6406"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="683.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1786" y="3964.7578"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="442.6797"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="631.4766"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="892.6719"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="950.9375"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="1542.7266"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="1600.9922"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="1789.7891"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="2075.1172"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="3150.1719"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="3208.4375"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="3412.3672"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="4081.2891"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1888" y="4270.0859"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="355.2813"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="1455.3281"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="3062.7734"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2037" y="3993.8906"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="413.5469"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="1513.5938"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="3121.0391"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2296" y="4052.1563"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="530.0781"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="1688.3906"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="3295.8359"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2396" y="4168.6875"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="863.5391"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="2045.9844"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="2626.0469"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="3587.1641"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2515" y="4589.5469"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="246.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="588.3438"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="270.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="1746.6563"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="117.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="2479.5156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="333.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2703.5" y="4226.9531"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3092" y="3354.1016"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3281" y="4473.0156"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="144.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="602.3438"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="168.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="1760.6563"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="178.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="2330.9844"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="3383.2344"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="532.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3436" y="4240.9531"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="776.1406"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="1958.5859"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="2538.6484"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="3499.7656"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3740" y="4443.8828"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3838" y="2421.25"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="102.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3838" y="2873.1094"/><rect fill="#FFFFFF" filter="url(#fmw2wna09i7on)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3838" y="4385.6172"/><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3869.5" x="3" y="209.0508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="209.0508" y2="209.0508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="212.0508" y2="212.0508"/><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="245" x="1815.25" y="198.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="227" x="1821.25" y="214.5513">FinTech asks for user account list</text><polygon fill="#0000FF" points="641,263.8828,651,267.8828,641,271.8828,645,267.8828" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="36" x2="647" y1="267.8828" y2="267.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="43" y="247.6841">GET /accounts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="43" y="262.8169">(Fintech user info, bank id, etc.)</text><polygon fill="#0000FF" points="854,293.0156,864,297.0156,854,301.0156,858,297.0156" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="663" x2="860" y1="297.0156" y2="297.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="670" y="291.9497">getAccounts</text><polygon fill="#0000FF" points="1774,322.1484,1784,326.1484,1774,330.1484,1778,326.1484" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="876" x2="1780" y1="326.1484" y2="326.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="883" y="321.0825">Facade.execute()</text><polygon fill="#0000FF" points="2025,351.2813,2035,355.2813,2025,359.2813,2029,355.2813" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1796" x2="2031" y1="355.2813" y2="355.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="1803" y="350.2153">Create facade context from request</text><polygon fill="#0000FF" points="1807,380.4141,1797,384.4141,1807,388.4141,1803,384.4141" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1801" x2="2041" y1="384.4141" y2="384.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1813" y="379.3481">ServiceContext</text><polygon fill="#0000FF" points="2284,409.5469,2294,413.5469,2284,417.5469,2288,413.5469" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1796" x2="2290" y1="413.5469" y2="413.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="318" x="1803" y="408.481">Select bank protocol from request type and bank id</text><polygon fill="#0000FF" points="1909,438.6797,1899,442.6797,1909,446.6797,1905,442.6797" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1903" x2="2295" y1="442.6797" y2="442.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="1915" y="437.6138">Read bank protocol using bank uuid and action id</text><polygon fill="#0000FF" points="2284,467.8125,2294,471.8125,2284,475.8125,2288,471.8125" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1893" x2="2290" y1="471.8125" y2="471.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1900" y="466.7466">BankProtocol</text><polygon fill="#0000FF" points="1807,496.9453,1797,500.9453,1807,504.9453,1803,500.9453" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1801" x2="2300" y1="500.9453" y2="500.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1813" y="495.8794">BankProtocol</text><polygon fill="#0000FF" points="2384,526.0781,2394,530.0781,2384,534.0781,2388,530.0781" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1796" x2="2390" y1="530.0781" y2="530.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="408" x="1803" y="525.0122">Find bean - Bean(BankProtocol.protocolBeanName) extends Action</text><polygon fill="#0000FF" points="1807,555.2109,1797,559.2109,1807,563.2109,1803,559.2109" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1801" x2="2400" y1="559.2109" y2="559.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1813" y="554.145">It is Xs2aListAccountsEntrypoint service bean</text><polygon fill="#0000FF" points="2691.5,584.3438,2701.5,588.3438,2691.5,592.3438,2695.5,588.3438" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1796" x2="2697.5" y1="588.3438" y2="588.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="1803" y="583.2778">Xs2aListAccountsEntrypoint.execute(ServiceContext)</text><polygon fill="#0000FF" points="3424,598.3438,3434,602.3438,3424,606.3438,3428,602.3438" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="2713.5" x2="3430" y1="602.3438" y2="602.3438"/><polygon fill="#0000FF" points="1909,627.4766,1899,631.4766,1909,635.4766,1905,631.4766" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1903" x2="3435" y1="631.4766" y2="631.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1915" y="626.4106">Consent for service session</text><polygon fill="#0000FF" points="3424,656.6094,3434,660.6094,3424,664.6094,3428,660.6094" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1893" x2="3430" y1="660.6094" y2="660.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="1900" y="655.5435">No consent</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="3446" x2="3488" y1="704.875" y2="704.875"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="3488" x2="3488" y1="704.875" y2="717.875"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="3447" x2="3488" y1="717.875" y2="717.875"/><polygon fill="#0000FF" points="3457,713.875,3447,717.875,3457,721.875,3453,717.875" style="stroke: #0000FF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="3453" y="684.6763">Validate API input -</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="3453" y="699.8091">do we have enough data (Mocked execution)</text><polygon fill="#0000FF" points="2724.5,743.0078,2714.5,747.0078,2724.5,751.0078,2720.5,747.0078" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="2718.5" x2="3440" y1="747.0078" y2="747.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="336" x="2730.5" y="741.9419">ValidationIssue[] -&gt; User input has missing parameters</text><polygon fill="#0000FF" points="3728,772.1406,3738,776.1406,3728,780.1406,3732,776.1406" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="2713.5" x2="3734" y1="776.1406" y2="776.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="2720.5" y="771.0747">Translate ValidationIssue[]</text><polygon fill="#0000FF" points="2724.5,801.2734,2714.5,805.2734,2724.5,809.2734,2720.5,805.2734" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="2718.5" x2="3744" y1="805.2734" y2="805.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="2730.5" y="800.2075">ContextBasedValidationErrorResult</text><polygon fill="#0000FF" points="1807,830.4063,1797,834.4063,1807,838.4063,1803,834.4063" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1801" x2="2707.5" y1="834.4063" y2="834.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="1813" y="829.3403">ContextBasedValidationErrorResult</text><polygon fill="#0000FF" points="2503,859.5391,2513,863.5391,2503,867.5391,2507,863.5391" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1796" x2="2509" y1="863.5391" y2="863.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="489" x="1803" y="858.4731">Translate ContextBasedValidationErrorResult -&gt; FacadeStartAuthorizationResult</text><polygon fill="#0000FF" points="1909,888.6719,1899,892.6719,1909,896.6719,1905,892.6719" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1903" x2="2514" y1="892.6719" y2="892.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="1915" y="887.606">Authorization session present?</text><polygon fill="#0000FF" points="2503,917.8047,2513,921.8047,2503,925.8047,2507,921.8047" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1893" x2="2509" y1="921.8047" y2="921.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="1900" y="916.7388">No authorization session</text><polygon fill="#0000FF" points="1909,946.9375,1899,950.9375,1909,954.9375,1905,950.9375" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1903" x2="2514" y1="950.9375" y2="950.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="1915" y="945.8716">Create authorization session</text><polygon fill="#0000FF" points="2503,976.0703,2513,980.0703,2503,984.0703,2507,980.0703" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1893" x2="2509" y1="980.0703" y2="980.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1900" y="975.0044">New authorization session</text><polygon fill="#0000FF" points="1807,1005.2031,1797,1009.2031,1807,1013.2031,1803,1009.2031" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1801" x2="2519" y1="1009.2031" y2="1009.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="1813" y="1004.1372">FacadeStartAuthorizationResult</text><polygon fill="#0000FF" points="887,1034.3359,877,1038.3359,887,1042.3359,883,1038.3359" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="881" x2="1790" y1="1038.3359" y2="1038.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="893" y="1033.27">process FacadeStartAuthorizationResult</text><polygon fill="#0000FF" points="1617.5,1063.4688,1627.5,1067.4688,1617.5,1071.4688,1621.5,1067.4688" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="876" x2="1623.5" y1="1067.4688" y2="1067.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="883" y="1062.4028">translate FacadeStartAuthorizationResult</text><polygon fill="#0000FF" points="887,1092.6016,877,1096.6016,887,1100.6016,883,1096.6016" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="881" x2="1633.5" y1="1096.6016" y2="1096.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="371" x="893" y="1091.5356">This is 202 code with redirection to Embedded authorization</text><polygon fill="#0000FF" points="674,1121.7344,664,1125.7344,674,1129.7344,670,1125.7344" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="668" x2="870" y1="1125.7344" y2="1125.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="680" y="1120.6685">202 Embedded authorization</text><polygon fill="#0000FF" points="47,1150.8672,37,1154.8672,47,1158.8672,43,1154.8672" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="41" x2="657" y1="1154.8672" y2="1154.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="53" y="1149.8013">202 Embedded authorization with dynamic form</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="36" x2="78" y1="1184" y2="1184"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="78" x2="78" y1="1184" y2="1197"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="37" x2="78" y1="1197" y2="1197"/><polygon fill="#0000FF" points="47,1193,37,1197,47,1201,43,1197" style="stroke: #0000FF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="43" y="1178.9341">Store</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="80" y="1178.9341">service session id</text><polygon fill="#FFA500" points="217,1252.3984,227,1256.3984,217,1260.3984,221,1256.3984" style="stroke: #FFA500; stroke-width: 1.0;"/><line style="stroke: #FFA500; stroke-width: 1.0;" x1="36" x2="223" y1="1256.3984" y2="1256.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="43" y="1221.0669">Redirect user to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="43" y="1236.1997">'Embedded authorization'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="43" y="1251.3325">form using 'Location' header</text><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3869.5" x="3" y="1284.9648"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="1284.9648" y2="1284.9648"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="1287.9648" y2="1287.9648"/><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="446" x="1714.75" y="1274.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="428" x="1720.75" y="1290.4653">User authorizes this request (embedded to provide i.e. PSU id)</text><path d="M196,1314.5313 L270,1314.5313 L270,1321.5313 L260,1331.5313 L196,1331.5313 L196,1314.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1036.4531" style="stroke: #000000; stroke-width: 2.0;" width="3632.5" x="196" y="1314.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="211" y="1327.5981">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="256" x="285" y="1326.7417">[Until user input has not enough parameters]</text><polygon fill="#008000" points="641,1363.9297,651,1367.9297,641,1371.9297,645,1367.9297" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="239" x2="647" y1="1367.9297" y2="1367.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="246" y="1347.731">POST /consent/embedded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="395" x="246" y="1362.8638">(Update context with 'Consent valid until', which accounts, etc.)</text><polygon fill="#008000" points="1039.5,1393.0625,1049.5,1397.0625,1039.5,1401.0625,1043.5,1397.0625" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="663" x2="1045.5" y1="1397.0625" y2="1397.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="670" y="1391.9966">embeddedUsingPOST</text><polygon fill="#008000" points="1774,1422.1953,1784,1426.1953,1774,1430.1953,1778,1426.1953" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1061.5" x2="1780" y1="1426.1953" y2="1426.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1068.5" y="1421.1294">Facade.execute()</text><polygon fill="#008000" points="2025,1451.3281,2035,1455.3281,2025,1459.3281,2029,1455.3281" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1796" x2="2031" y1="1455.3281" y2="1455.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="1803" y="1450.2622">Create facade context from request</text><polygon fill="#008000" points="1807,1480.4609,1797,1484.4609,1807,1488.4609,1803,1484.4609" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1801" x2="2041" y1="1484.4609" y2="1484.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1813" y="1479.395">ServiceContext</text><polygon fill="#008000" points="2284,1509.5938,2294,1513.5938,2284,1517.5938,2288,1513.5938" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1796" x2="2290" y1="1513.5938" y2="1513.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="1803" y="1508.5278">Select bank protocol by using authorization session id</text><polygon fill="#008000" points="1909,1538.7266,1899,1542.7266,1909,1546.7266,1905,1542.7266" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1903" x2="2295" y1="1542.7266" y2="1542.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="327" x="1915" y="1537.6606">Read authorization session using authId from request</text><polygon fill="#008000" points="2284,1567.8594,2294,1571.8594,2284,1575.8594,2288,1571.8594" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1893" x2="2290" y1="1571.8594" y2="1571.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="1900" y="1566.7935">AuthorizationSession</text><polygon fill="#008000" points="1909,1596.9922,1899,1600.9922,1909,1604.9922,1905,1600.9922" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1903" x2="2295" y1="1600.9922" y2="1600.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="379" x="1915" y="1595.9263">Read bank protocol using AuthorizationSession.bankProtocolId</text><polygon fill="#008000" points="2284,1626.125,2294,1630.125,2284,1634.125,2288,1630.125" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1893" x2="2290" y1="1630.125" y2="1630.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1900" y="1625.0591">BankProtocol</text><polygon fill="#008000" points="1807,1655.2578,1797,1659.2578,1807,1663.2578,1803,1659.2578" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1801" x2="2300" y1="1659.2578" y2="1659.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1813" y="1654.1919">BankProtocol</text><polygon fill="#008000" points="2384,1684.3906,2394,1688.3906,2384,1692.3906,2388,1688.3906" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1796" x2="2390" y1="1688.3906" y2="1688.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="408" x="1803" y="1683.3247">Find bean - Bean(BankProtocol.protocolBeanName) extends Action</text><polygon fill="#008000" points="1807,1713.5234,1797,1717.5234,1807,1721.5234,1803,1717.5234" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1801" x2="2400" y1="1717.5234" y2="1717.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="1813" y="1712.4575">It is Xs2aUpdateAuthorization service bean</text><polygon fill="#008000" points="2691.5,1742.6563,2701.5,1746.6563,2691.5,1750.6563,2695.5,1746.6563" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1796" x2="2697.5" y1="1746.6563" y2="1746.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="1803" y="1741.5903">Xs2aListAccountsEntrypoint.execute(ServiceContext)</text><polygon fill="#008000" points="3424,1756.6563,3434,1760.6563,3424,1764.6563,3428,1760.6563" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="2713.5" x2="3430" y1="1760.6563" y2="1760.6563"/><polygon fill="#008000" points="1909,1785.7891,1899,1789.7891,1909,1793.7891,1905,1789.7891" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1903" x2="3435" y1="1789.7891" y2="1789.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1915" y="1784.7231">Consent for service session</text><polygon fill="#008000" points="3424,1814.9219,3434,1818.9219,3424,1822.9219,3428,1818.9219" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1893" x2="3430" y1="1818.9219" y2="1818.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="1900" y="1813.856">No consent</text><path d="M206,1833.9219 L269,1833.9219 L269,1840.9219 L259,1850.9219 L206,1850.9219 L206,1833.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="510.0625" style="stroke: #000000; stroke-width: 2.0;" width="3612.5" x="206" y="1833.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="221" y="1846.9888">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="182" x="284" y="1846.1323">[User supplied not enough data]</text><line style="stroke: #008000; stroke-width: 1.0;" x1="3446" x2="3488" y1="1887.3203" y2="1887.3203"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3488" x2="3488" y1="1887.3203" y2="1900.3203"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3447" x2="3488" y1="1900.3203" y2="1900.3203"/><polygon fill="#008000" points="3457,1896.3203,3447,1900.3203,3457,1904.3203,3453,1900.3203" style="stroke: #008000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="3453" y="1867.1216">Validate API input -</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="3453" y="1882.2544">do we have enough data (Mocked execution)</text><polygon fill="#008000" points="2724.5,1925.4531,2714.5,1929.4531,2724.5,1933.4531,2720.5,1929.4531" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="2718.5" x2="3440" y1="1929.4531" y2="1929.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="336" x="2730.5" y="1924.3872">ValidationIssue[] -&gt; User input has missing parameters</text><polygon fill="#008000" points="3728,1954.5859,3738,1958.5859,3728,1962.5859,3732,1958.5859" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="2713.5" x2="3734" y1="1958.5859" y2="1958.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="2720.5" y="1953.52">Translate ValidationIssue[]</text><polygon fill="#008000" points="2724.5,1983.7188,2714.5,1987.7188,2724.5,1991.7188,2720.5,1987.7188" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="2718.5" x2="3744" y1="1987.7188" y2="1987.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="2730.5" y="1982.6528">ContextBasedValidationErrorResult</text><polygon fill="#008000" points="1807,2012.8516,1797,2016.8516,1807,2020.8516,1803,2016.8516" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1801" x2="2707.5" y1="2016.8516" y2="2016.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="1813" y="2011.7856">ContextBasedValidationErrorResult</text><polygon fill="#008000" points="2503,2041.9844,2513,2045.9844,2503,2049.9844,2507,2045.9844" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1796" x2="2509" y1="2045.9844" y2="2045.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="489" x="1803" y="2040.9185">Translate ContextBasedValidationErrorResult -&gt; FacadeStartAuthorizationResult</text><polygon fill="#008000" points="1909,2071.1172,1899,2075.1172,1909,2079.1172,1905,2075.1172" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1903" x2="2514" y1="2075.1172" y2="2075.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="1915" y="2070.0513">Authorization session present?</text><polygon fill="#008000" points="2503,2100.25,2513,2104.25,2503,2108.25,2507,2104.25" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1893" x2="2509" y1="2104.25" y2="2104.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="1900" y="2099.1841">AuthorizationSession</text><polygon fill="#008000" points="1807,2129.3828,1797,2133.3828,1807,2137.3828,1803,2133.3828" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1801" x2="2519" y1="2133.3828" y2="2133.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="1813" y="2128.3169">FacadeRedirectResult</text><polygon fill="#008000" points="1077.5,2158.5156,1067.5,2162.5156,1077.5,2166.5156,1073.5,2162.5156" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1071.5" x2="1785" y1="2162.5156" y2="2162.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="1083.5" y="2157.4497">process FacadeRedirectResult</text><polygon fill="#008000" points="1617.5,2187.6484,1627.5,2191.6484,1617.5,2195.6484,1621.5,2191.6484" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1066.5" x2="1623.5" y1="2191.6484" y2="2191.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="1073.5" y="2186.5825">translate FacadeRedirectResult</text><polygon fill="#008000" points="1077.5,2216.7813,1067.5,2220.7813,1077.5,2224.7813,1073.5,2220.7813" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1071.5" x2="1633.5" y1="2220.7813" y2="2220.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="539" x="1083.5" y="2215.7153">This is 303 code with redirection to Embedded authorization dynamic form continuation</text><polygon fill="#008000" points="674,2245.9141,664,2249.9141,674,2253.9141,670,2249.9141" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="668" x2="1055.5" y1="2249.9141" y2="2249.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="680" y="2244.8481">303 Embedded authorization</text><polygon fill="#008000" points="250,2275.0469,240,2279.0469,250,2283.0469,246,2279.0469" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="244" x2="652" y1="2279.0469" y2="2279.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="256" y="2273.981">303 Embedded authorization</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="206" x2="3818.5" y1="2288.0469" y2="2288.0469"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="233" x="211" y="2298.2573">[User supplied all necessary parameters]</text><line style="stroke: #008000; stroke-width: 1.0;" x1="3441" x2="3488" y1="2317.9844" y2="2317.9844"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3488" x2="3488" y1="2317.9844" y2="2330.9844"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3447" x2="3488" y1="2330.9844" y2="2330.9844"/><polygon fill="#008000" points="3457,2326.9844,3447,2330.9844,3457,2334.9844,3453,2330.9844" style="stroke: #008000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="3453" y="2312.9185">User input OK</text><line style="stroke: #008000; stroke-width: 1.0;" x1="3446" x2="3488" y1="2379.1172" y2="2379.1172"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3488" x2="3488" y1="2379.1172" y2="2392.1172"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3447" x2="3488" y1="2392.1172" y2="2392.1172"/><polygon fill="#008000" points="3457,2388.1172,3447,2392.1172,3457,2396.1172,3453,2392.1172" style="stroke: #008000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="3453" y="2374.0513">Switch to real execution mode</text><polygon fill="#008000" points="3826,2417.25,3836,2421.25,3826,2425.25,3830,2421.25" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3446" x2="3832" y1="2421.25" y2="2421.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="3453" y="2416.1841">Initiate consent</text><polygon fill="#008000" points="3457,2446.3828,3447,2450.3828,3457,2454.3828,3453,2450.3828" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="3451" x2="3842" y1="2450.3828" y2="2450.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="3463" y="2445.3169">Redirect authorization required</text><polygon fill="#008000" points="2724.5,2475.5156,2714.5,2479.5156,2724.5,2483.5156,2720.5,2479.5156" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="2718.5" x2="3435" y1="2479.5156" y2="2479.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="2730.5" y="2474.4497">Redirect to ASPSP required</text><polygon fill="#008000" points="3728,2534.6484,3738,2538.6484,3728,2542.6484,3732,2538.6484" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="2713.5" x2="3734" y1="2538.6484" y2="2538.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="2720.5" y="2533.5825">Translate 'Redirect to ASPSP required'</text><polygon fill="#008000" points="2724.5,2563.7813,2714.5,2567.7813,2724.5,2571.7813,2720.5,2567.7813" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="2718.5" x2="3744" y1="2567.7813" y2="2567.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="2730.5" y="2562.7153">ContextBasedAuthorizationRequiredResult</text><polygon fill="#008000" points="1807,2592.9141,1797,2596.9141,1807,2600.9141,1803,2596.9141" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1801" x2="2707.5" y1="2596.9141" y2="2596.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="1813" y="2591.8481">ContextBasedAuthorizationRequiredResult</text><polygon fill="#008000" points="2503,2622.0469,2513,2626.0469,2503,2630.0469,2507,2626.0469" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1796" x2="2509" y1="2626.0469" y2="2626.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="1803" y="2620.981">Translate RedirectionResult -&gt; FacadeRedirectResult</text><polygon fill="#008000" points="1807,2651.1797,1797,2655.1797,1807,2659.1797,1803,2655.1797" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1801" x2="2519" y1="2655.1797" y2="2655.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="1813" y="2650.1138">FacadeRedirectResult</text><polygon fill="#008000" points="1077.5,2680.3125,1067.5,2684.3125,1077.5,2688.3125,1073.5,2684.3125" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1071.5" x2="1790" y1="2684.3125" y2="2684.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="1083.5" y="2679.2466">FacadeRedirectResult</text><polygon fill="#008000" points="1617.5,2709.4453,1627.5,2713.4453,1617.5,2717.4453,1621.5,2713.4453" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1066.5" x2="1623.5" y1="2713.4453" y2="2713.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="1073.5" y="2708.3794">translate FacadeRedirectResult</text><polygon fill="#008000" points="1077.5,2738.5781,1067.5,2742.5781,1077.5,2746.5781,1073.5,2742.5781" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="1071.5" x2="1633.5" y1="2742.5781" y2="2742.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="376" x="1083.5" y="2737.5122">This is 303 code with redirection to ASPSP authorization page</text><polygon fill="#008000" points="674,2767.7109,664,2771.7109,674,2775.7109,670,2771.7109" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="668" x2="1050.5" y1="2771.7109" y2="2771.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="680" y="2766.645">303 Redirect to ASPSP</text><polygon fill="#008000" points="250,2796.8438,240,2800.8438,250,2804.8438,246,2800.8438" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="244" x2="657" y1="2800.8438" y2="2800.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="256" y="2795.7778">303 ASPSP 'Login page'</text><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3869.5" x="3" y="2829.4102"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="2829.4102" y2="2829.4102"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="2832.4102" y2="2832.4102"/><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="365" x="1755.25" y="2818.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="347" x="1761.25" y="2834.9106">User authorizes this request with ASPSP (redirect)</text><polygon fill="#FFA500" points="3826,2869.1094,3836,2873.1094,3826,2877.1094,3830,2873.1094" style="stroke: #FFA500; stroke-width: 1.0;"/><line style="stroke: #FFA500; stroke-width: 1.0;" x1="239" x2="3832" y1="2873.1094" y2="2873.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="246" y="2868.0435">Authorization</text><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3869.5" x="3" y="2901.6758"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="2901.6758" y2="2901.6758"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="2904.6758" y2="2904.6758"/><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="297" x="1789.25" y="2891.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="279" x="1795.25" y="2907.1763">ASPSP reports consent authorization OK</text><polygon fill="#FF00FF" points="674,2941.375,664,2945.375,674,2949.375,670,2945.375" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="668" x2="3837" y1="2945.375" y2="2945.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="680" y="2940.3091">GET /from/aspsp/ok webhook</text><polygon fill="#FF00FF" points="1044.5,3000.5078,1054.5,3004.5078,1044.5,3008.5078,1048.5,3004.5078" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="663" x2="1050.5" y1="3004.5078" y2="3004.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="670" y="2999.4419">fromAspspOkUsingGET</text><polygon fill="#FF00FF" points="1774,3029.6406,1784,3033.6406,1774,3037.6406,1778,3033.6406" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1066.5" x2="1780" y1="3033.6406" y2="3033.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1073.5" y="3028.5747">Facade.execute()</text><polygon fill="#FF00FF" points="2025,3058.7734,2035,3062.7734,2025,3066.7734,2029,3062.7734" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1796" x2="2031" y1="3062.7734" y2="3062.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="1803" y="3057.7075">Create facade context from request</text><polygon fill="#FF00FF" points="1807,3087.9063,1797,3091.9063,1807,3095.9063,1803,3091.9063" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1801" x2="2041" y1="3091.9063" y2="3091.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1813" y="3086.8403">ServiceContext</text><polygon fill="#FF00FF" points="2284,3117.0391,2294,3121.0391,2284,3125.0391,2288,3121.0391" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1796" x2="2290" y1="3121.0391" y2="3121.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="1803" y="3115.9731">Select bank protocol by using authorization session id</text><polygon fill="#FF00FF" points="1909,3146.1719,1899,3150.1719,1909,3154.1719,1905,3150.1719" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1903" x2="2295" y1="3150.1719" y2="3150.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="1915" y="3145.106">Read authorization session</text><polygon fill="#FF00FF" points="2284,3175.3047,2294,3179.3047,2284,3183.3047,2288,3179.3047" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1893" x2="2290" y1="3179.3047" y2="3179.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="1900" y="3174.2388">AuthorizationSession</text><polygon fill="#FF00FF" points="1909,3204.4375,1899,3208.4375,1909,3212.4375,1905,3208.4375" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1903" x2="2295" y1="3208.4375" y2="3208.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="379" x="1915" y="3203.3716">Read bank protocol using AuthorizationSession.bankProtocolId</text><polygon fill="#FF00FF" points="2284,3233.5703,2294,3237.5703,2284,3241.5703,2288,3237.5703" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1893" x2="2290" y1="3237.5703" y2="3237.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1900" y="3232.5044">BankProtocol</text><polygon fill="#FF00FF" points="1807,3262.7031,1797,3266.7031,1807,3270.7031,1803,3266.7031" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1801" x2="2300" y1="3266.7031" y2="3266.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1813" y="3261.6372">BankProtocol</text><polygon fill="#FF00FF" points="2384,3291.8359,2394,3295.8359,2384,3299.8359,2388,3295.8359" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1796" x2="2390" y1="3295.8359" y2="3295.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="408" x="1803" y="3290.77">Find bean - Bean(BankProtocol.protocolBeanName) extends Action</text><polygon fill="#FF00FF" points="1807,3320.9688,1797,3324.9688,1807,3328.9688,1803,3324.9688" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1801" x2="2400" y1="3324.9688" y2="3324.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="1813" y="3319.9028">It is Xs2aFromAspspRedirect service bean</text><polygon fill="#FF00FF" points="3080,3350.1016,3090,3354.1016,3080,3358.1016,3084,3354.1016" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1796" x2="3086" y1="3354.1016" y2="3354.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="1803" y="3349.0356">Xs2aListAccountsEntrypoint.execute(ServiceContext)</text><polygon fill="#FF00FF" points="3424,3379.2344,3434,3383.2344,3424,3387.2344,3428,3383.2344" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="3102" x2="3430" y1="3383.2344" y2="3383.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="3109" y="3378.1685">Bank approved consent</text><polygon fill="#FF00FF" points="1909,3408.3672,1899,3412.3672,1909,3416.3672,1905,3412.3672" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1903" x2="3435" y1="3412.3672" y2="3412.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="1915" y="3407.3013">Persist consent and its context</text><polygon fill="#FF00FF" points="3424,3437.5,3434,3441.5,3424,3445.5,3428,3441.5" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1893" x2="3430" y1="3441.5" y2="3441.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="1900" y="3436.4341">Done</text><polygon fill="#FF00FF" points="3113,3466.6328,3103,3470.6328,3113,3474.6328,3109,3470.6328" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="3107" x2="3440" y1="3470.6328" y2="3470.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="3119" y="3465.5669">Consent acquired</text><polygon fill="#FF00FF" points="3728,3495.7656,3738,3499.7656,3728,3503.7656,3732,3499.7656" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="3102" x2="3734" y1="3499.7656" y2="3499.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="3109" y="3494.6997">Translate 'Consent acquired'</text><polygon fill="#FF00FF" points="3113,3524.8984,3103,3528.8984,3113,3532.8984,3109,3528.8984" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="3107" x2="3744" y1="3528.8984" y2="3528.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="3119" y="3523.8325">ConsentAcquiredResult</text><polygon fill="#FF00FF" points="1807,3554.0313,1797,3558.0313,1807,3562.0313,1803,3558.0313" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1801" x2="3096" y1="3558.0313" y2="3558.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="1813" y="3552.9653">ConsentAcquiredResult</text><polygon fill="#FF00FF" points="2503,3583.1641,2513,3587.1641,2503,3591.1641,2507,3587.1641" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1796" x2="2509" y1="3587.1641" y2="3587.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="363" x="1803" y="3582.0981">Translate ConsentAcquiredResult -&gt; FacadeRedirectResult</text><polygon fill="#FF00FF" points="1807,3612.2969,1797,3616.2969,1807,3620.2969,1803,3616.2969" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1801" x2="2519" y1="3616.2969" y2="3616.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="1813" y="3611.231">FacadeRedirectResult</text><polygon fill="#FF00FF" points="1077.5,3626.2969,1067.5,3630.2969,1077.5,3634.2969,1073.5,3630.2969" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1071.5" x2="1790" y1="3630.2969" y2="3630.2969"/><polygon fill="#FF00FF" points="1617.5,3655.4297,1627.5,3659.4297,1617.5,3663.4297,1621.5,3659.4297" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1066.5" x2="1623.5" y1="3659.4297" y2="3659.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="1073.5" y="3654.3638">translate FacadeRedirectResult</text><polygon fill="#FF00FF" points="1077.5,3684.5625,1067.5,3688.5625,1077.5,3692.5625,1073.5,3688.5625" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1071.5" x2="1633.5" y1="3688.5625" y2="3688.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="1083.5" y="3683.4966">This is 303 code with redirection to FinTech</text><polygon fill="#FF00FF" points="674,3713.6953,664,3717.6953,674,3721.6953,670,3717.6953" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="668" x2="1055.5" y1="3717.6953" y2="3717.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="680" y="3712.6294">303 Redirect to FinTech</text><polygon fill="#FF00FF" points="250,3742.8281,240,3746.8281,250,3750.8281,246,3746.8281" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="244" x2="657" y1="3746.8281" y2="3746.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="256" y="3741.7622">303 FinTech 'Thanks for consent' page</text><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3869.5" x="3" y="3775.3945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="3775.3945" y2="3775.3945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="3778.3945" y2="3778.3945"/><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="379" x="1748.25" y="3764.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="361" x="1754.25" y="3780.895">Fintech receives notification that consent is received</text><polygon fill="#FFA500" points="47,3815.0938,37,3819.0938,47,3823.0938,43,3819.0938" style="stroke: #FFA500; stroke-width: 1.0;"/><line style="stroke: #FFA500; stroke-width: 1.0;" x1="41" x2="233" y1="3819.0938" y2="3819.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="53" y="3814.0278">Back to FinTech screen</text><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3869.5" x="3" y="3847.6602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="3847.6602" y2="3847.6602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3872.5" y1="3850.6602" y2="3850.6602"/><rect fill="#EEEEEE" filter="url(#fmw2wna09i7on)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="379" x="1748.25" y="3837.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="361" x="1754.25" y="3853.1606">Fintech calls user account list within same session id</text><polygon fill="#A80036" points="641,3902.4922,651,3906.4922,641,3910.4922,645,3906.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36" x2="647" y1="3906.4922" y2="3906.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="43" y="3886.2935">GET /accounts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="47" y="3901.4263">with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="77" y="3901.4263">service session id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="200" y="3901.4263">and Fintech user info, bank id, etc.</text><polygon fill="#A80036" points="854,3931.625,864,3935.625,854,3939.625,858,3935.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="860" y1="3935.625" y2="3935.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="670" y="3930.5591">getAccounts</text><polygon fill="#A80036" points="1774,3960.7578,1784,3964.7578,1774,3968.7578,1778,3964.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="876" x2="1780" y1="3964.7578" y2="3964.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="883" y="3959.6919">Facade.execute()</text><polygon fill="#A80036" points="2025,3989.8906,2035,3993.8906,2025,3997.8906,2029,3993.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1796" x2="2031" y1="3993.8906" y2="3993.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="1803" y="3988.8247">Create facade context from request</text><polygon fill="#A80036" points="1807,4019.0234,1797,4023.0234,1807,4027.0234,1803,4023.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1801" x2="2041" y1="4023.0234" y2="4023.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1813" y="4017.9575">ServiceContext</text><polygon fill="#A80036" points="2284,4048.1563,2294,4052.1563,2284,4056.1563,2288,4052.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1796" x2="2290" y1="4052.1563" y2="4052.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="318" x="1803" y="4047.0903">Select bank protocol from request type and bank id</text><polygon fill="#A80036" points="1909,4077.2891,1899,4081.2891,1909,4085.2891,1905,4081.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1903" x2="2295" y1="4081.2891" y2="4081.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="1915" y="4076.2231">Read bank protocol using bank uuid and action id</text><polygon fill="#A80036" points="2284,4106.4219,2294,4110.4219,2284,4114.4219,2288,4110.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1893" x2="2290" y1="4110.4219" y2="4110.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1900" y="4105.356">BankProtocol</text><polygon fill="#A80036" points="1807,4135.5547,1797,4139.5547,1807,4143.5547,1803,4139.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1801" x2="2300" y1="4139.5547" y2="4139.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1813" y="4134.4888">BankProtocol</text><polygon fill="#A80036" points="2384,4164.6875,2394,4168.6875,2384,4172.6875,2388,4168.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1796" x2="2390" y1="4168.6875" y2="4168.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="408" x="1803" y="4163.6216">Find bean - Bean(BankProtocol.protocolBeanName) extends Action</text><polygon fill="#A80036" points="1807,4193.8203,1797,4197.8203,1807,4201.8203,1803,4197.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1801" x2="2400" y1="4197.8203" y2="4197.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1813" y="4192.7544">It is Xs2aListAccountsEntrypoint service bean</text><polygon fill="#A80036" points="2691.5,4222.9531,2701.5,4226.9531,2691.5,4230.9531,2695.5,4226.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1796" x2="2697.5" y1="4226.9531" y2="4226.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="1803" y="4221.8872">Xs2aListAccountsEntrypoint.execute(ServiceContext)</text><polygon fill="#A80036" points="3424,4236.9531,3434,4240.9531,3424,4244.9531,3428,4240.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2713.5" x2="3430" y1="4240.9531" y2="4240.9531"/><polygon fill="#A80036" points="1909,4266.0859,1899,4270.0859,1909,4274.0859,1905,4270.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1903" x2="3435" y1="4270.0859" y2="4270.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="1915" y="4265.02">Consent for service session</text><polygon fill="#A80036" points="3424,4295.2188,3434,4299.2188,3424,4303.2188,3428,4299.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1893" x2="3430" y1="4299.2188" y2="4299.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="1900" y="4294.1528">Consent present,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="2011" y="4294.1528">consent context</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="3446" x2="3488" y1="4343.4844" y2="4343.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3488" x2="3488" y1="4343.4844" y2="4356.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3447" x2="3488" y1="4356.4844" y2="4356.4844"/><polygon fill="#A80036" points="3457,4352.4844,3447,4356.4844,3457,4360.4844,3453,4356.4844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="3453" y="4323.2856">Validate</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="3506" y="4323.2856">consent context</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3620" y="4323.2856">-</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="3453" y="4338.4185">do we have enough data (Mocked execution)</text><polygon fill="#A80036" points="3826,4381.6172,3836,4385.6172,3826,4389.6172,3830,4385.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3446" x2="3832" y1="4385.6172" y2="4385.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="3453" y="4380.5513">Call ASPSP with consent using</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="3641" y="4380.5513">consent context</text><polygon fill="#A80036" points="3457,4410.75,3447,4414.75,3457,4418.75,3453,4414.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3451" x2="3842" y1="4414.75" y2="4414.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="3463" y="4409.6841">Users' accounts</text><polygon fill="#A80036" points="3728,4439.8828,3738,4443.8828,3728,4447.8828,3732,4443.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3446" x2="3734" y1="4443.8828" y2="4443.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="3453" y="4438.8169">Translate ASPSP response</text><polygon fill="#A80036" points="3302,4469.0156,3292,4473.0156,3302,4477.0156,3298,4473.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3296" x2="3739" y1="4473.0156" y2="4473.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="3308" y="4467.9497">Translate ASPSP response</text><polygon fill="#A80036" points="3728,4498.1484,3738,4502.1484,3728,4506.1484,3732,4502.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3286" x2="3734" y1="4502.1484" y2="4502.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="3293" y="4497.0825">Account list</text><polygon fill="#A80036" points="2724.5,4527.2813,2714.5,4531.2813,2724.5,4535.2813,2720.5,4531.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2718.5" x2="3744" y1="4531.2813" y2="4531.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="2730.5" y="4526.2153">Account list</text><polygon fill="#A80036" points="1807,4556.4141,1797,4560.4141,1807,4564.4141,1803,4560.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1801" x2="2707.5" y1="4560.4141" y2="4560.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="1813" y="4555.3481">SuccessResult&lt;Account list&gt;</text><polygon fill="#A80036" points="2503,4585.5469,2513,4589.5469,2503,4593.5469,2507,4589.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1796" x2="2509" y1="4589.5469" y2="4589.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="1803" y="4584.481">Translate SuccessResult -&gt; FacadeSuccessResult</text><polygon fill="#A80036" points="1807,4614.6797,1797,4618.6797,1807,4622.6797,1803,4618.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1801" x2="2519" y1="4618.6797" y2="4618.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="1813" y="4613.6138">FacadeSuccessResult</text><polygon fill="#A80036" points="887,4643.8125,877,4647.8125,887,4651.8125,883,4647.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="1790" y1="4647.8125" y2="4647.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="893" y="4642.7466">FacadeSuccessResult</text><polygon fill="#A80036" points="1617.5,4672.9453,1627.5,4676.9453,1617.5,4680.9453,1621.5,4676.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="876" x2="1623.5" y1="4676.9453" y2="4676.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="883" y="4671.8794">translate FacadeSuccessResult</text><polygon fill="#A80036" points="887,4702.0781,877,4706.0781,887,4710.0781,883,4706.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="1633.5" y1="4706.0781" y2="4706.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="893" y="4701.0122">This is 200 code with Account list body</text><polygon fill="#A80036" points="674,4731.2109,664,4735.2109,674,4739.2109,670,4735.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="668" x2="870" y1="4735.2109" y2="4735.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="680" y="4730.145">200 and Account list</text><polygon fill="#A80036" points="47,4760.3438,37,4764.3438,47,4768.3438,43,4764.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41" x2="657" y1="4764.3438" y2="4764.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="53" y="4759.2778">200 and Account list</text><rect fill="#DDDDDD" height="75.1875" rx="5" ry="5" style="stroke: #000000; stroke-width: 1.0;" width="278" x="11" y="11"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="17" y="28.9951">Combined</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="228" x="17" y="45.292">embedded (Extra user parameters)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="220" x="17" y="61.5889">and redirect (ASPSP authorization)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="17" y="77.8857">authorization when</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="148" y="77.8857">consent is missing</text><!--MD5=[08d65398053296dc176e4907257febbb]
@startuml
legend top left
  <b>Combined</b>
  embedded (Extra user parameters)
  and redirect (ASPSP authorization)
  authorization when  <b>consent is missing</b>
endlegend

actor FinTech
actor User

collections TppBackend

box "TPP API"
control TppBankingApiAisController
control ConsentServiceController
participant FacadeResponseMapper
endbox

box "OPBA-Facade"
collections FacadeService
database Database
participant ServiceContextProvider
participant ProtocolSelector
participant Spring
participant ProtocolResultHandler
endbox

box "XS2A-Protocol"
participant Xs2aListAccountsEntrypoint
participant Xs2aUpdateAuthorization
participant Xs2aFromAspspRedirect
participant Xs2aResultBodyExtractor
collections Xs2aServices
participant OutcomeMapper
endbox

boundary ASPSP


== FinTech asks for user account list ==
FinTech [#blue]-> TppBackend ++ : GET /accounts\n(Fintech user info, bank id, etc.)
TppBackend [#blue]-> TppBankingApiAisController ++ : getAccounts
TppBankingApiAisController [#blue]-> FacadeService ++ : Facade.execute()
FacadeService [#blue]-> ServiceContextProvider ++ : Create facade context from request
FacadeService <-[#blue] ServiceContextProvider - - : ServiceContext
FacadeService [#blue]-> ProtocolSelector ++ : Select bank protocol from request type and bank id
ProtocolSelector [#blue]-> Database ++ : Read bank protocol using bank uuid and action id
Database [#blue]-> ProtocolSelector - - : BankProtocol
ProtocolSelector [#blue]-> FacadeService - - : BankProtocol
FacadeService [#blue]-> Spring ++ : Find bean - Bean(BankProtocol.protocolBeanName) extends Action
FacadeService <-[#blue] Spring - - : It is Xs2aListAccountsEntrypoint service bean
FacadeService [#blue]-> Xs2aListAccountsEntrypoint ++ : Xs2aListAccountsEntrypoint.execute(ServiceContext)
Xs2aListAccountsEntrypoint [#blue]-> Xs2aServices ++
Xs2aServices [#blue]-> Database ++ : Consent for service session
Xs2aServices <-[#blue] Database - - : No consent
Xs2aServices [#blue]-> Xs2aServices : Validate API input -\ndo we have enough data (Mocked execution)
Xs2aServices [#blue]-> Xs2aListAccountsEntrypoint - - : ValidationIssue[] -> User input has missing parameters
Xs2aListAccountsEntrypoint [#blue]-> OutcomeMapper ++ : Translate ValidationIssue[]
OutcomeMapper [#blue]-> Xs2aListAccountsEntrypoint - - : ContextBasedValidationErrorResult
Xs2aListAccountsEntrypoint [#blue]-> FacadeService - - : ContextBasedValidationErrorResult
FacadeService [#blue]-> ProtocolResultHandler ++ : Translate ContextBasedValidationErrorResult -> FacadeStartAuthorizationResult
ProtocolResultHandler [#blue]-> Database ++ : Authorization session present?
Database [#blue]-> ProtocolResultHandler - - : No authorization session
ProtocolResultHandler [#blue]-> Database ++ : Create authorization session
ProtocolResultHandler <-[#blue] Database - - : New authorization session
ProtocolResultHandler [#blue]-> FacadeService - - : FacadeStartAuthorizationResult
FacadeService [#blue]-> TppBankingApiAisController - - : process FacadeStartAuthorizationResult
TppBankingApiAisController [#blue]-> FacadeResponseMapper ++ : translate FacadeStartAuthorizationResult
FacadeResponseMapper [#blue]-> TppBankingApiAisController - - : This is 202 code with redirection to Embedded authorization
TppBankingApiAisController [#blue]-> TppBackend - - : 202 Embedded authorization
TppBackend [#blue]-> FinTech - - : 202 Embedded authorization with dynamic form
FinTech [#blue]-> FinTech: Store <b>service session id</b>

FinTech [#orange]-> User ++ : Redirect user to\n'Embedded authorization'\nform using 'Location' header


== User authorizes this request (embedded to provide i.e. PSU id) ==
loop Until user input has not enough parameters
User [#green]-> TppBackend ++ : POST /consent/embedded\n(Update context with 'Consent valid until', which accounts, etc.)
TppBackend [#green]-> ConsentServiceController ++ : embeddedUsingPOST
ConsentServiceController [#green]-> FacadeService ++ : Facade.execute()
FacadeService [#green]-> ServiceContextProvider ++ : Create facade context from request
FacadeService <-[#green] ServiceContextProvider - - : ServiceContext
FacadeService [#green]-> ProtocolSelector ++: Select bank protocol by using authorization session id
ProtocolSelector [#green]-> Database ++ : Read authorization session using authId from request
Database [#green]-> ProtocolSelector - - : AuthorizationSession
ProtocolSelector [#green]-> Database ++ : Read bank protocol using AuthorizationSession.bankProtocolId
Database [#green]-> ProtocolSelector - - : BankProtocol
ProtocolSelector [#green]-> FacadeService - - : BankProtocol
FacadeService [#green]-> Spring ++ : Find bean - Bean(BankProtocol.protocolBeanName) extends Action
FacadeService <-[#green] Spring - - : It is Xs2aUpdateAuthorization service bean
FacadeService [#green]-> Xs2aListAccountsEntrypoint ++ : Xs2aListAccountsEntrypoint.execute(ServiceContext)
Xs2aListAccountsEntrypoint [#green]-> Xs2aServices ++
Xs2aServices [#green]-> Database ++ : Consent for service session
Xs2aServices <-[#green] Database - - : No consent
alt User supplied not enough data
  Xs2aServices [#green]-> Xs2aServices : Validate API input -\ndo we have enough data (Mocked execution)
  Xs2aServices [#green]-> Xs2aListAccountsEntrypoint - - : ValidationIssue[] -> User input has missing parameters
  Xs2aListAccountsEntrypoint [#green]-> OutcomeMapper ++ : Translate ValidationIssue[]
  OutcomeMapper [#green]-> Xs2aListAccountsEntrypoint - - : ContextBasedValidationErrorResult
  Xs2aListAccountsEntrypoint [#green]-> FacadeService - - : ContextBasedValidationErrorResult
  FacadeService [#green]-> ProtocolResultHandler ++ : Translate ContextBasedValidationErrorResult -> FacadeStartAuthorizationResult
  ProtocolResultHandler [#green]-> Database ++ : Authorization session present?
  Database [#green]-> ProtocolResultHandler - - : AuthorizationSession
  ProtocolResultHandler [#green]-> FacadeService - - : FacadeRedirectResult
  FacadeService [#green]-> ConsentServiceController ++ : process FacadeRedirectResult
  ConsentServiceController [#green]-> FacadeResponseMapper ++ : translate FacadeRedirectResult
  FacadeResponseMapper [#green]-> ConsentServiceController - - : This is 303 code with redirection to Embedded authorization dynamic form continuation
  ConsentServiceController [#green]-> TppBackend  : 303 Embedded authorization
  TppBackend [#green]-> User : 303 Embedded authorization
else User supplied all necessary parameters
  Xs2aServices [#green]-> Xs2aServices ++ : User input OK
end
end

Xs2aServices [#green]-> Xs2aServices : Switch to real execution mode
Xs2aServices [#green]-> ASPSP ++ : Initiate consent
ASPSP [#green]-> Xs2aServices - - : Redirect authorization required
Xs2aServices [#green]-> Xs2aListAccountsEntrypoint ++ : Redirect to ASPSP required
deactivate Xs2aServices
Xs2aListAccountsEntrypoint [#green]-> OutcomeMapper ++ : Translate 'Redirect to ASPSP required'
OutcomeMapper [#green]-> Xs2aListAccountsEntrypoint - - : ContextBasedAuthorizationRequiredResult
Xs2aListAccountsEntrypoint [#green]-> FacadeService - - : ContextBasedAuthorizationRequiredResult
FacadeService [#green]-> ProtocolResultHandler ++ : Translate RedirectionResult -> FacadeRedirectResult
ProtocolResultHandler [#green]-> FacadeService - - : FacadeRedirectResult
FacadeService [#green]-> ConsentServiceController - - : FacadeRedirectResult
ConsentServiceController [#green]-> FacadeResponseMapper ++ : translate FacadeRedirectResult
FacadeResponseMapper [#green]-> ConsentServiceController - - : This is 303 code with redirection to ASPSP authorization page
ConsentServiceController [#green]-> TppBackend - - : 303 Redirect to ASPSP
TppBackend [#green]-> User - - : 303 ASPSP 'Login page'


== User authorizes this request with ASPSP (redirect) ==
User [#orange]-> ASPSP ++ : Authorization


== ASPSP reports consent authorization OK ==
ASPSP [#magenta]-> TppBackend ++ : <b>GET /from/aspsp/ok webhook</b>
deactivate ASPSP
TppBackend [#magenta]-> ConsentServiceController ++ : fromAspspOkUsingGET
ConsentServiceController [#magenta]-> FacadeService ++ : Facade.execute()
FacadeService [#magenta]-> ServiceContextProvider ++ : Create facade context from request
FacadeService <-[#magenta] ServiceContextProvider - - : ServiceContext
FacadeService [#magenta]-> ProtocolSelector ++ : Select bank protocol by using authorization session id
ProtocolSelector [#magenta]-> Database ++ : Read authorization session
Database [#magenta]-> ProtocolSelector - - : AuthorizationSession
ProtocolSelector [#magenta]-> Database ++ : Read bank protocol using AuthorizationSession.bankProtocolId
Database [#magenta]-> ProtocolSelector - - : BankProtocol
ProtocolSelector [#magenta]-> FacadeService - - : BankProtocol
FacadeService [#magenta]-> Spring ++ : Find bean - Bean(BankProtocol.protocolBeanName) extends Action
FacadeService <-[#magenta] Spring - - : It is Xs2aFromAspspRedirect service bean
FacadeService [#magenta]-> Xs2aFromAspspRedirect ++ : Xs2aListAccountsEntrypoint.execute(ServiceContext)
Xs2aFromAspspRedirect [#magenta]-> Xs2aServices ++ : Bank approved consent
Xs2aServices [#magenta]-> Database ++ : Persist consent and its context
Database [#magenta]-> Xs2aServices - - : Done
Xs2aServices [#magenta]-> Xs2aFromAspspRedirect - - : Consent acquired
Xs2aFromAspspRedirect [#magenta]-> OutcomeMapper ++ : Translate 'Consent acquired'
OutcomeMapper [#magenta]-> Xs2aFromAspspRedirect - - : ConsentAcquiredResult
Xs2aFromAspspRedirect [#magenta]-> FacadeService - - : ConsentAcquiredResult
FacadeService [#magenta]-> ProtocolResultHandler ++ : Translate ConsentAcquiredResult -> FacadeRedirectResult
ProtocolResultHandler [#magenta]-> FacadeService - - : FacadeRedirectResult
FacadeService [#magenta]-> ConsentServiceController - -
ConsentServiceController [#magenta]-> FacadeResponseMapper ++ : translate FacadeRedirectResult
FacadeResponseMapper [#magenta]-> ConsentServiceController - - : This is 303 code with redirection to FinTech
ConsentServiceController [#magenta]-> TppBackend - - : 303 Redirect to FinTech
deactivate ConsentServiceController
TppBackend [#magenta]-> User - - : 303 FinTech 'Thanks for consent' page


== Fintech receives notification that consent is received ==
User [#orange]-> FinTech - - : Back to FinTech screen

== Fintech calls user account list within same session id ==
FinTech -> TppBackend ++ : GET /accounts\n with <b>service session id</b> and Fintech user info, bank id, etc.
TppBackend -> TppBankingApiAisController ++ : getAccounts
TppBankingApiAisController -> FacadeService ++ : Facade.execute()
FacadeService -> ServiceContextProvider ++ : Create facade context from request
FacadeService <- ServiceContextProvider - - : ServiceContext
FacadeService -> ProtocolSelector ++ : Select bank protocol from request type and bank id
ProtocolSelector -> Database ++ : Read bank protocol using bank uuid and action id
Database -> ProtocolSelector - - : BankProtocol
ProtocolSelector -> FacadeService - - : BankProtocol
FacadeService -> Spring ++ : Find bean - Bean(BankProtocol.protocolBeanName) extends Action
FacadeService <- Spring - - : It is Xs2aListAccountsEntrypoint service bean
FacadeService -> Xs2aListAccountsEntrypoint ++ : Xs2aListAccountsEntrypoint.execute(ServiceContext)
Xs2aListAccountsEntrypoint -> Xs2aServices ++
Xs2aServices -> Database ++ : Consent for service session
Xs2aServices <- Database - - : Consent present, <b>consent context</b>
Xs2aServices -> Xs2aServices : Validate <b>consent context</b> -\ndo we have enough data (Mocked execution)
Xs2aServices -> ASPSP ++ : Call ASPSP with consent using <b>consent context</b>
ASPSP -> Xs2aServices - - : Users' accounts
Xs2aServices -> OutcomeMapper ++ : Translate ASPSP response
OutcomeMapper -> Xs2aResultBodyExtractor ++: Translate ASPSP response
Xs2aResultBodyExtractor -> OutcomeMapper - - : Account list
OutcomeMapper -> Xs2aListAccountsEntrypoint - - : Account list
Xs2aListAccountsEntrypoint -> FacadeService - - : SuccessResult<Account list>
FacadeService -> ProtocolResultHandler ++ : Translate SuccessResult -> FacadeSuccessResult
ProtocolResultHandler -> FacadeService - - : FacadeSuccessResult
FacadeService -> TppBankingApiAisController - - : FacadeSuccessResult
TppBankingApiAisController -> FacadeResponseMapper ++ : translate FacadeSuccessResult
FacadeResponseMapper -> TppBankingApiAisController - - : This is 200 code with Account list body
TppBankingApiAisController -> TppBackend - -: 200 and Account list
TppBackend -> FinTech - - : 200 and Account list
@enduml

PlantUML version 1.2019.11(Sun Sep 22 13:02:15 EEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.5+10-b520.30
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>