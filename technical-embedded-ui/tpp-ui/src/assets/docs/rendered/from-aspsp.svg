<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1226px" preserveAspectRatio="none" style="width:3071px;height:1226px;" version="1.1" viewBox="0 0 3071 1226" width="3071px" zoomAndPan="magnify"><defs><filter height="300%" id="flvk0uqxvttmf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1119.4453" style="stroke: #A80036; stroke-width: 1.0;" width="675.5" x="415" y="96.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="726.25" y="108.2544">TPP API</text><rect fill="#DDDDDD" height="1119.4453" style="stroke: #A80036; stroke-width: 1.0;" width="875" x="1092.5" y="96.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="1484" y="108.2544">OPBA-Facade</text><rect fill="#DDDDDD" height="1119.4453" style="stroke: #A80036; stroke-width: 1.0;" width="1030" x="1969.5" y="96.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="2435" y="108.2544">XS2A-Protocol</text><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="801.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="353" y="252.75"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="713.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="691" y="311.8828"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="993" y="966.8047"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="596.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1149.5" y="341.0156"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1251.5" y="457.5469"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1251.5" y="515.8125"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1251.5" y="719.7422"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1400.5" y="370.1484"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1659.5" y="428.4141"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1759.5" y="603.2109"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1878.5" y="894.5391"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2455.5" y="661.4766"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2799.5" y="690.6094"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2927" y="807.1406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="36" x2="36" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="92" x2="92" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="358" x2="358" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="510" x2="510" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="696" x2="696" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="997.5" x2="997.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1154.5" x2="1154.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1256.5" x2="1256.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1405" x2="1405" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1664.5" x2="1664.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1764.5" x2="1764.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1883.5" x2="1883.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2071.5" x2="2071.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2271.5" x2="2271.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2460.5" x2="2460.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2649.5" x2="2649.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2804.5" x2="2804.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2931.5" x2="2931.5" y1="178.4844" y2="1129.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3029.5" x2="3029.5" y1="178.4844" y2="1129.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="8" y="175.1826">FinTech</text><ellipse cx="36" cy="105.1875" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M36,113.1875 L36,140.1875 M23,121.1875 L49,121.1875 M36,140.1875 L23,155.1875 M36,140.1875 L49,155.1875 " fill="none" filter="url(#flvk0uqxvttmf)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="8" y="1141.3311">FinTech</text><ellipse cx="36" cy="1154.6328" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M36,1162.6328 L36,1189.6328 M23,1170.6328 L49,1170.6328 M36,1189.6328 L23,1204.6328 M36,1189.6328 L49,1204.6328 " fill="none" filter="url(#flvk0uqxvttmf)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="74" y="175.1826">User</text><ellipse cx="92" cy="105.1875" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M92,113.1875 L92,140.1875 M79,121.1875 L105,121.1875 M92,140.1875 L79,155.1875 M92,140.1875 L105,155.1875 " fill="none" filter="url(#flvk0uqxvttmf)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="74" y="1141.3311">User</text><ellipse cx="92" cy="1154.6328" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M92,1162.6328 L92,1189.6328 M79,1170.6328 L105,1170.6328 M92,1189.6328 L79,1204.6328 M92,1189.6328 L105,1204.6328 " fill="none" filter="url(#flvk0uqxvttmf)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="311" y="139.1875"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="307" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="314" y="163.1826">TppBackend</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="311" y="1128.3359"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="307" y="1132.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="314" y="1152.3311">TppBackend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="177" x="419" y="175.1826">TppBankingApiAisController</text><ellipse cx="510.5" cy="146.1875" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="506.5,134.1875,512.5,129.1875,510.5,134.1875,512.5,139.1875,506.5,134.1875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="177" x="419" y="1141.3311">TppBankingApiAisController</text><ellipse cx="510.5" cy="1160.6328" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="506.5,1148.6328,512.5,1143.6328,510.5,1148.6328,512.5,1153.6328,506.5,1148.6328" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="612" y="175.1826">ConsentServiceController</text><ellipse cx="696" cy="146.1875" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="692,134.1875,698,129.1875,696,134.1875,698,139.1875,692,134.1875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="612" y="1141.3311">ConsentServiceController</text><ellipse cx="696" cy="1160.6328" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="692,1148.6328,698,1143.6328,696,1148.6328,698,1153.6328,692,1148.6328" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="909.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="916.5" y="163.1826">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="173" x="909.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="916.5" y="1148.3311">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1100.5" y="139.1875"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1096.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1103.5" y="163.1826">FacadeService</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1100.5" y="1128.3359"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1096.5" y="1132.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1103.5" y="1152.3311">FacadeService</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1222.5" y="175.1826">Database</text><path d="M1238.5,126.1875 C1238.5,116.1875 1256.5,116.1875 1256.5,116.1875 C1256.5,116.1875 1274.5,116.1875 1274.5,126.1875 L1274.5,152.1875 C1274.5,162.1875 1256.5,162.1875 1256.5,162.1875 C1256.5,162.1875 1238.5,162.1875 1238.5,152.1875 L1238.5,126.1875 " fill="#FEFECE" filter="url(#flvk0uqxvttmf)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1238.5,126.1875 C1238.5,136.1875 1256.5,136.1875 1256.5,136.1875 C1256.5,136.1875 1274.5,136.1875 1274.5,126.1875 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1222.5" y="1141.3311">Database</text><path d="M1238.5,1154.6328 C1238.5,1144.6328 1256.5,1144.6328 1256.5,1144.6328 C1256.5,1144.6328 1274.5,1144.6328 1274.5,1154.6328 L1274.5,1180.6328 C1274.5,1190.6328 1256.5,1190.6328 1256.5,1190.6328 C1256.5,1190.6328 1238.5,1190.6328 1238.5,1180.6328 L1238.5,1154.6328 " fill="#FEFECE" filter="url(#flvk0uqxvttmf)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1238.5,1154.6328 C1238.5,1164.6328 1256.5,1164.6328 1256.5,1164.6328 C1256.5,1164.6328 1274.5,1164.6328 1274.5,1154.6328 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="1321" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="1328" y="163.1826">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="1321" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="1328" y="1148.3311">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1603.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="1610.5" y="163.1826">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="1603.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="1610.5" y="1148.3311">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="1735.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="1742.5" y="163.1826">Spring</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="1735.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="1742.5" y="1148.3311">Spring</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="1803.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="142" x="1810.5" y="163.1826">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="1803.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="142" x="1810.5" y="1148.3311">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="1973.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="1980.5" y="163.1826">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="1973.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="1980.5" y="1148.3311">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="2180.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="2187.5" y="163.1826">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="2180.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="2187.5" y="1148.3311">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="2372.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="2379.5" y="163.1826">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="2372.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="2379.5" y="1148.3311">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="2558.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="2565.5" y="163.1826">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="2558.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="164" x="2565.5" y="1148.3311">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="2754.5" y="139.1875"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="2750.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="2757.5" y="163.1826">Xs2aServices</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="2754.5" y="1128.3359"/><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="2750.5" y="1132.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="2757.5" y="1152.3311">Xs2aServices</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="2868.5" y="143.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="2875.5" y="163.1826">OutcomeMapper</text><rect fill="#FEFECE" filter="url(#flvk0uqxvttmf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="2868.5" y="1128.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="2875.5" y="1148.3311">OutcomeMapper</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="3006.5" y="175.1826">ASPSP</text><path d="M3009.5,134.1875 L3009.5,158.1875 M3009.5,146.1875 L3026.5,146.1875 " fill="none" filter="url(#flvk0uqxvttmf)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3038.5" cy="146.1875" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="3006.5" y="1141.3311">ASPSP</text><path d="M3009.5,1148.6328 L3009.5,1172.6328 M3009.5,1160.6328 L3026.5,1160.6328 " fill="none" filter="url(#flvk0uqxvttmf)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3038.5" cy="1160.6328" fill="#FEFECE" filter="url(#flvk0uqxvttmf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="801.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="353" y="252.75"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="713.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="691" y="311.8828"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="993" y="966.8047"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="596.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1149.5" y="341.0156"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1251.5" y="457.5469"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1251.5" y="515.8125"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1251.5" y="719.7422"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1400.5" y="370.1484"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="145.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1659.5" y="428.4141"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1759.5" y="603.2109"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1878.5" y="894.5391"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="203.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2455.5" y="661.4766"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2799.5" y="690.6094"/><rect fill="#FFFFFF" filter="url(#flvk0uqxvttmf)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2927" y="807.1406"/><rect fill="#EEEEEE" filter="url(#flvk0uqxvttmf)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3056.5" x="3" y="209.0508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3059.5" y1="209.0508" y2="209.0508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3059.5" y1="212.0508" y2="212.0508"/><rect fill="#EEEEEE" filter="url(#flvk0uqxvttmf)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="297" x="1382.75" y="198.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="279" x="1388.75" y="214.5513">ASPSP reports consent authorization OK</text><polygon fill="#FF00FF" points="374,248.75,364,252.75,374,256.75,370,252.75" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="368" x2="3029" y1="252.75" y2="252.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="380" y="247.6841">GET /from/aspsp/ok webhook</text><polygon fill="#FF00FF" points="679,307.8828,689,311.8828,679,315.8828,683,311.8828" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="363" x2="685" y1="311.8828" y2="311.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="370" y="306.8169">fromAspspOkUsingGET</text><polygon fill="#FF00FF" points="1137.5,337.0156,1147.5,341.0156,1137.5,345.0156,1141.5,341.0156" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="701" x2="1143.5" y1="341.0156" y2="341.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="708" y="335.9497">Facade.execute()</text><polygon fill="#FF00FF" points="1388.5,366.1484,1398.5,370.1484,1388.5,374.1484,1392.5,370.1484" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1159.5" x2="1394.5" y1="370.1484" y2="370.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="1166.5" y="365.0825">Create facade context from request</text><polygon fill="#FF00FF" points="1170.5,395.2813,1160.5,399.2813,1170.5,403.2813,1166.5,399.2813" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1164.5" x2="1404.5" y1="399.2813" y2="399.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1176.5" y="394.2153">ServiceContext</text><polygon fill="#FF00FF" points="1647.5,424.4141,1657.5,428.4141,1647.5,432.4141,1651.5,428.4141" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1159.5" x2="1653.5" y1="428.4141" y2="428.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="1166.5" y="423.3481">Select bank protocol by using authorization session id</text><polygon fill="#FF00FF" points="1272.5,453.5469,1262.5,457.5469,1272.5,461.5469,1268.5,457.5469" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1266.5" x2="1658.5" y1="457.5469" y2="457.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="1278.5" y="452.481">Read authorization session</text><polygon fill="#FF00FF" points="1647.5,482.6797,1657.5,486.6797,1647.5,490.6797,1651.5,486.6797" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1256.5" x2="1653.5" y1="486.6797" y2="486.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="1263.5" y="481.6138">AuthorizationSession</text><polygon fill="#FF00FF" points="1272.5,511.8125,1262.5,515.8125,1272.5,519.8125,1268.5,515.8125" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1266.5" x2="1658.5" y1="515.8125" y2="515.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="379" x="1278.5" y="510.7466">Read bank protocol using AuthorizationSession.bankProtocolId</text><polygon fill="#FF00FF" points="1647.5,540.9453,1657.5,544.9453,1647.5,548.9453,1651.5,544.9453" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1256.5" x2="1653.5" y1="544.9453" y2="544.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1263.5" y="539.8794">BankProtocol</text><polygon fill="#FF00FF" points="1170.5,570.0781,1160.5,574.0781,1170.5,578.0781,1166.5,574.0781" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1164.5" x2="1663.5" y1="574.0781" y2="574.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="1176.5" y="569.0122">BankProtocol</text><polygon fill="#FF00FF" points="1747.5,599.2109,1757.5,603.2109,1747.5,607.2109,1751.5,603.2109" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1159.5" x2="1753.5" y1="603.2109" y2="603.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="408" x="1166.5" y="598.145">Find bean - Bean(BankProtocol.protocolBeanName) extends Action</text><polygon fill="#FF00FF" points="1170.5,628.3438,1160.5,632.3438,1170.5,636.3438,1166.5,632.3438" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1164.5" x2="1763.5" y1="632.3438" y2="632.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="1176.5" y="627.2778">It is Xs2aFromAspspRedirect service bean</text><polygon fill="#FF00FF" points="2443.5,657.4766,2453.5,661.4766,2443.5,665.4766,2447.5,661.4766" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1159.5" x2="2449.5" y1="661.4766" y2="661.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="1166.5" y="656.4106">Xs2aListAccountsEntrypoint.execute(ServiceContext)</text><polygon fill="#FF00FF" points="2787.5,686.6094,2797.5,690.6094,2787.5,694.6094,2791.5,690.6094" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="2465.5" x2="2793.5" y1="690.6094" y2="690.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="2472.5" y="685.5435">Bank approved consent</text><polygon fill="#FF00FF" points="1272.5,715.7422,1262.5,719.7422,1272.5,723.7422,1268.5,719.7422" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1266.5" x2="2798.5" y1="719.7422" y2="719.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="1278.5" y="714.6763">Persist consent and its context</text><polygon fill="#FF00FF" points="2787.5,744.875,2797.5,748.875,2787.5,752.875,2791.5,748.875" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1256.5" x2="2793.5" y1="748.875" y2="748.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="1263.5" y="743.8091">Done</text><polygon fill="#FF00FF" points="2476.5,774.0078,2466.5,778.0078,2476.5,782.0078,2472.5,778.0078" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="2470.5" x2="2803.5" y1="778.0078" y2="778.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="2482.5" y="772.9419">Consent acquired</text><polygon fill="#FF00FF" points="2915,803.1406,2925,807.1406,2915,811.1406,2919,807.1406" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="2465.5" x2="2921" y1="807.1406" y2="807.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="2472.5" y="802.0747">Translate 'Consent acquired'</text><polygon fill="#FF00FF" points="2476.5,832.2734,2466.5,836.2734,2476.5,840.2734,2472.5,836.2734" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="2470.5" x2="2931" y1="836.2734" y2="836.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="2482.5" y="831.2075">ConsentAcquiredResult</text><polygon fill="#FF00FF" points="1170.5,861.4063,1160.5,865.4063,1170.5,869.4063,1166.5,865.4063" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1164.5" x2="2459.5" y1="865.4063" y2="865.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="1176.5" y="860.3403">ConsentAcquiredResult</text><polygon fill="#FF00FF" points="1866.5,890.5391,1876.5,894.5391,1866.5,898.5391,1870.5,894.5391" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1159.5" x2="1872.5" y1="894.5391" y2="894.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="363" x="1166.5" y="889.4731">Translate ConsentAcquiredResult -&gt; FacadeRedirectResult</text><polygon fill="#FF00FF" points="1170.5,919.6719,1160.5,923.6719,1170.5,927.6719,1166.5,923.6719" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="1164.5" x2="1882.5" y1="923.6719" y2="923.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="1176.5" y="918.606">FacadeRedirectResult</text><polygon fill="#FF00FF" points="712,933.6719,702,937.6719,712,941.6719,708,937.6719" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="706" x2="1153.5" y1="937.6719" y2="937.6719"/><polygon fill="#FF00FF" points="981,962.8047,991,966.8047,981,970.8047,985,966.8047" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="701" x2="987" y1="966.8047" y2="966.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="708" y="961.7388">translate FacadeRedirectResult</text><polygon fill="#FF00FF" points="712,991.9375,702,995.9375,712,999.9375,708,995.9375" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="706" x2="997" y1="995.9375" y2="995.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="718" y="990.8716">This is 303 code with redirection to FinTech</text><polygon fill="#FF00FF" points="374,1021.0703,364,1025.0703,374,1029.0703,370,1025.0703" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="368" x2="695" y1="1025.0703" y2="1025.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="380" y="1020.0044">303 Redirect to FinTech</text><polygon fill="#FF00FF" points="103,1050.2031,93,1054.2031,103,1058.2031,99,1054.2031" style="stroke: #FF00FF; stroke-width: 1.0;"/><line style="stroke: #FF00FF; stroke-width: 1.0;" x1="97" x2="357" y1="1054.2031" y2="1054.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="109" y="1049.1372">303 FinTech 'Thanks for consent' page</text><rect fill="#EEEEEE" filter="url(#flvk0uqxvttmf)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3056.5" x="3" y="1082.7695"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3059.5" y1="1082.7695" y2="1082.7695"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3059.5" y1="1085.7695" y2="1085.7695"/><rect fill="#EEEEEE" filter="url(#flvk0uqxvttmf)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="379" x="1341.75" y="1072.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="361" x="1347.75" y="1088.27">Fintech receives notification that consent is received</text><polygon fill="#FFA500" points="47,1107.3359,37,1111.3359,47,1115.3359,43,1111.3359" style="stroke: #FFA500; stroke-width: 1.0;"/><line style="stroke: #FFA500; stroke-width: 1.0;" x1="41" x2="91" y1="1111.3359" y2="1111.3359"/><rect fill="#DDDDDD" height="75.1875" rx="5" ry="5" style="stroke: #000000; stroke-width: 1.0;" width="278" x="11" y="11"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="75" x="17" y="28.9951">Combined</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="228" x="17" y="45.292">embedded (Extra user parameters)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="220" x="17" y="61.5889">and redirect (ASPSP authorization)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="17" y="77.8857">authorization when</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="148" y="77.8857">consent is missing</text><!--MD5=[e6f9a6d3ac62c2ae94b46ab2483deaf0]
@startuml
legend top left
  <b>Combined</b>
  embedded (Extra user parameters)
  and redirect (ASPSP authorization)
  authorization when  <b>consent is missing</b>
endlegend

actor FinTech
actor User

collections TppBackend

box "TPP API"
control TppBankingApiAisController
control ConsentServiceController
participant FacadeResponseMapper
endbox

box "OPBA-Facade"
collections FacadeService
database Database
participant ServiceContextProvider
participant ProtocolSelector
participant Spring
participant ProtocolResultHandler
endbox

box "XS2A-Protocol"
participant Xs2aListAccountsEntrypoint
participant Xs2aUpdateAuthorization
participant Xs2aFromAspspRedirect
participant Xs2aResultBodyExtractor
collections Xs2aServices
participant OutcomeMapper
endbox

boundary ASPSP
== ASPSP reports consent authorization OK ==
ASPSP [#magenta]-> TppBackend ++ : <b>GET /from/aspsp/ok webhook</b>
deactivate ASPSP
TppBackend [#magenta]-> ConsentServiceController ++ : fromAspspOkUsingGET
ConsentServiceController [#magenta]-> FacadeService ++ : Facade.execute()
FacadeService [#magenta]-> ServiceContextProvider ++ : Create facade context from request
FacadeService <-[#magenta] ServiceContextProvider - - : ServiceContext
FacadeService [#magenta]-> ProtocolSelector ++ : Select bank protocol by using authorization session id
ProtocolSelector [#magenta]-> Database ++ : Read authorization session
Database [#magenta]-> ProtocolSelector - - : AuthorizationSession
ProtocolSelector [#magenta]-> Database ++ : Read bank protocol using AuthorizationSession.bankProtocolId
Database [#magenta]-> ProtocolSelector - - : BankProtocol
ProtocolSelector [#magenta]-> FacadeService - - : BankProtocol
FacadeService [#magenta]-> Spring ++ : Find bean - Bean(BankProtocol.protocolBeanName) extends Action
FacadeService <-[#magenta] Spring - - : It is Xs2aFromAspspRedirect service bean
FacadeService [#magenta]-> Xs2aFromAspspRedirect ++ : Xs2aListAccountsEntrypoint.execute(ServiceContext)
Xs2aFromAspspRedirect [#magenta]-> Xs2aServices ++ : Bank approved consent
Xs2aServices [#magenta]-> Database ++ : Persist consent and its context
Database [#magenta]-> Xs2aServices - - : Done
Xs2aServices [#magenta]-> Xs2aFromAspspRedirect - - : Consent acquired
Xs2aFromAspspRedirect [#magenta]-> OutcomeMapper ++ : Translate 'Consent acquired'
OutcomeMapper [#magenta]-> Xs2aFromAspspRedirect - - : ConsentAcquiredResult
Xs2aFromAspspRedirect [#magenta]-> FacadeService - - : ConsentAcquiredResult
FacadeService [#magenta]-> ProtocolResultHandler ++ : Translate ConsentAcquiredResult -> FacadeRedirectResult
ProtocolResultHandler [#magenta]-> FacadeService - - : FacadeRedirectResult
FacadeService [#magenta]-> ConsentServiceController - -
ConsentServiceController [#magenta]-> FacadeResponseMapper ++ : translate FacadeRedirectResult
FacadeResponseMapper [#magenta]-> ConsentServiceController - - : This is 303 code with redirection to FinTech
ConsentServiceController [#magenta]-> TppBackend - - : 303 Redirect to FinTech
deactivate ConsentServiceController
TppBackend [#magenta]-> User - - : 303 FinTech 'Thanks for consent' page

== Fintech receives notification that consent is received ==
User [#orange]-> FinTech
@enduml

PlantUML version 1.2019.11(Sun Sep 22 13:02:15 EEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.5+10-b520.30
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>