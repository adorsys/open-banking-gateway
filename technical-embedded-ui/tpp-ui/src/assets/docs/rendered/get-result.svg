<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1163px" preserveAspectRatio="none" style="width:3274px;height:1163px;" version="1.1" viewBox="0 0 3274 1163" width="3274px" zoomAndPan="magnify"><defs><filter height="300%" id="f13zdmgxnqgagk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1104.7109" style="stroke: #A80036; stroke-width: 1.0;" width="598" x="510.5" y="47.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="781" y="59.3638">TPP API</text><rect fill="#DDDDDD" height="1104.7109" style="stroke: #A80036; stroke-width: 1.0;" width="833" x="1110.5" y="47.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="1477" y="59.3638">OPBA-Facade</text><rect fill="#DDDDDD" height="1104.7109" style="stroke: #A80036; stroke-width: 1.0;" width="1255" x="1945.5" y="47.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="2521" y="59.3638">XS2A-Protocol</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="38" x2="38" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="449.5" x2="449.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="612.5" x2="612.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="812.5" x2="812.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1008.5" x2="1008.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1175.5" x2="1175.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1282.5" x2="1282.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1428.5" x2="1428.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1619.5" x2="1619.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1726.5" x2="1726.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1853.5" x2="1853.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2054.5" x2="2054.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2265.5" x2="2265.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2466.5" x2="2466.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2666.5" x2="2666.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2829.5" x2="2829.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3129.5" x2="3129.5" y1="129.5938" y2="1065.7109"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3231.5" x2="3231.5" y1="129.5938" y2="1065.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="8" y="126.292">FinTech</text><ellipse cx="38.5" cy="56.2969" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M38.5,64.2969 L38.5,91.2969 M25.5,72.2969 L51.5,72.2969 M38.5,91.2969 L25.5,106.2969 M38.5,91.2969 L51.5,106.2969 " fill="none" filter="url(#f13zdmgxnqgagk)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="8" y="1077.7061">FinTech</text><ellipse cx="38.5" cy="1091.0078" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M38.5,1099.0078 L38.5,1126.0078 M25.5,1107.0078 L51.5,1107.0078 M38.5,1126.0078 L25.5,1141.0078 M38.5,1126.0078 L51.5,1141.0078 " fill="none" filter="url(#f13zdmgxnqgagk)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="398.5" y="90.2969"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="394.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="401.5" y="114.292">TppBackend</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="398.5" y="1064.7109"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="394.5" y="1068.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="401.5" y="1088.7061">TppBackend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="191" x="514.5" y="126.292">TppBankingApiAisController</text><ellipse cx="613" cy="97.2969" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="609,85.2969,615,80.2969,613,85.2969,615,90.2969,609,85.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="191" x="514.5" y="1077.7061">TppBankingApiAisController</text><ellipse cx="613" cy="1097.0078" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="609,1085.0078,615,1080.0078,613,1085.0078,615,1090.0078,609,1085.0078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="176" x="721.5" y="126.292">ConsentServiceController</text><ellipse cx="812.5" cy="97.2969" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="808.5,85.2969,814.5,80.2969,812.5,85.2969,814.5,90.2969,808.5,85.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="176" x="721.5" y="1077.7061">ConsentServiceController</text><ellipse cx="812.5" cy="1097.0078" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="808.5,1085.0078,814.5,1080.0078,812.5,1085.0078,814.5,1090.0078,808.5,1085.0078" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="913.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="920.5" y="114.292">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="913.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="920.5" y="1084.7061">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1118.5" y="90.2969"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1114.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1121.5" y="114.292">FacadeService</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1118.5" y="1064.7109"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1114.5" y="1068.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1121.5" y="1088.7061">FacadeService</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="1246.5" y="126.292">Database</text><path d="M1264.5,77.2969 C1264.5,67.2969 1282.5,67.2969 1282.5,67.2969 C1282.5,67.2969 1300.5,67.2969 1300.5,77.2969 L1300.5,103.2969 C1300.5,113.2969 1282.5,113.2969 1282.5,113.2969 C1282.5,113.2969 1264.5,113.2969 1264.5,103.2969 L1264.5,77.2969 " fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1264.5,77.2969 C1264.5,87.2969 1282.5,87.2969 1282.5,87.2969 C1282.5,87.2969 1300.5,87.2969 1300.5,77.2969 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="1246.5" y="1077.7061">Database</text><path d="M1264.5,1091.0078 C1264.5,1081.0078 1282.5,1081.0078 1282.5,1081.0078 C1282.5,1081.0078 1300.5,1081.0078 1300.5,1091.0078 L1300.5,1117.0078 C1300.5,1127.0078 1282.5,1127.0078 1282.5,1127.0078 C1282.5,1127.0078 1264.5,1127.0078 1264.5,1117.0078 L1264.5,1091.0078 " fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1264.5,1091.0078 C1264.5,1101.0078 1282.5,1101.0078 1282.5,1101.0078 C1282.5,1101.0078 1300.5,1101.0078 1300.5,1091.0078 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="174" x="1339.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="1346.5" y="114.292">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="174" x="1339.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="1346.5" y="1084.7061">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="1553.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1560.5" y="114.292">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="1553.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1560.5" y="1084.7061">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="1695.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="1702.5" y="114.292">Spring</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="1695.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="1702.5" y="1084.7061">Spring</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="1767.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="1774.5" y="114.292">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="1767.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="1774.5" y="1084.7061">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="1949.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="1956.5" y="114.292">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="1949.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="1956.5" y="1084.7061">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="189" x="2169.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="2176.5" y="114.292">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="189" x="2169.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="2176.5" y="1084.7061">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="2372.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="2379.5" y="114.292">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="2372.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="2379.5" y="1084.7061">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="2570.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="174" x="2577.5" y="114.292">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="2570.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="174" x="2577.5" y="1084.7061">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2776.5" y="90.2969"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2772.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="2779.5" y="114.292">Xs2aServices</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2776.5" y="1064.7109"/><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2772.5" y="1068.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="2779.5" y="1088.7061">Xs2aServices</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="3062.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="3069.5" y="114.292">OutcomeMapper</text><rect fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="3062.5" y="1064.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="3069.5" y="1084.7061">OutcomeMapper</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="3206.5" y="126.292">ASPSP</text><path d="M3211.5,85.2969 L3211.5,109.2969 M3211.5,97.2969 L3228.5,97.2969 " fill="none" filter="url(#f13zdmgxnqgagk)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3240.5" cy="97.2969" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="3206.5" y="1077.7061">ASPSP</text><path d="M3211.5,1085.0078 L3211.5,1109.0078 M3211.5,1097.0078 L3228.5,1097.0078 " fill="none" filter="url(#f13zdmgxnqgagk)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3240.5" cy="1097.0078" fill="#FEFECE" filter="url(#f13zdmgxnqgagk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#EEEEEE" filter="url(#f13zdmgxnqgagk)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3259.5" x="3" y="160.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3262.5" y1="160.1602" y2="160.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3262.5" y1="163.1602" y2="163.1602"/><rect fill="#EEEEEE" filter="url(#f13zdmgxnqgagk)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="411" x="1427.25" y="149.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="392" x="1433.25" y="165.6606">Fintech calls user account list within same session id</text><polygon fill="#A80036" points="437.5,214.9922,447.5,218.9922,437.5,222.9922,441.5,218.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="38.5" x2="443.5" y1="218.9922" y2="218.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="45.5" y="198.7935">GET /accounts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="49.5" y="213.9263">with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="78.5" y="213.9263">service session id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="213.5" y="213.9263">and Fintech user info, bank id, etc.</text><polygon fill="#A80036" points="601,244.125,611,248.125,601,252.125,605,248.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449.5" x2="607" y1="248.125" y2="248.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="456.5" y="243.0591">getAccounts</text><polygon fill="#A80036" points="1163.5,273.2578,1173.5,277.2578,1163.5,281.2578,1167.5,277.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="613" x2="1169.5" y1="277.2578" y2="277.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="620" y="272.1919">Facade.execute()</text><polygon fill="#A80036" points="1416.5,302.3906,1426.5,306.3906,1416.5,310.3906,1420.5,306.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1422.5" y1="306.3906" y2="306.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="1182.5" y="301.3247">Create facade context from request</text><polygon fill="#A80036" points="1186.5,331.5234,1176.5,335.5234,1186.5,339.5234,1182.5,335.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="1427.5" y1="335.5234" y2="335.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="1192.5" y="330.4575">ServiceContext</text><polygon fill="#A80036" points="1607.5,360.6563,1617.5,364.6563,1607.5,368.6563,1611.5,364.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1613.5" y1="364.6563" y2="364.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="1182.5" y="359.5903">Select bank protocol from request type and bank id</text><polygon fill="#A80036" points="1293.5,389.7891,1283.5,393.7891,1293.5,397.7891,1289.5,393.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1287.5" x2="1618.5" y1="393.7891" y2="393.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="1299.5" y="388.7231">Read bank protocol using bank uuid and action id</text><polygon fill="#A80036" points="1607.5,418.9219,1617.5,422.9219,1607.5,426.9219,1611.5,422.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1282.5" x2="1613.5" y1="422.9219" y2="422.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="1289.5" y="417.856">BankProtocol</text><polygon fill="#A80036" points="1186.5,448.0547,1176.5,452.0547,1186.5,456.0547,1182.5,452.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="1618.5" y1="452.0547" y2="452.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="1192.5" y="446.9888">BankProtocol</text><polygon fill="#A80036" points="1714.5,477.1875,1724.5,481.1875,1714.5,485.1875,1718.5,481.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1720.5" y1="481.1875" y2="481.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="429" x="1182.5" y="476.1216">Find bean - Bean(BankProtocol.protocolBeanName) extends Action</text><polygon fill="#A80036" points="1186.5,506.3203,1176.5,510.3203,1186.5,514.3203,1182.5,510.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="1725.5" y1="510.3203" y2="510.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="1192.5" y="505.2544">It is Xs2aListAccountsEntrypoint service bean</text><polygon fill="#A80036" points="2042.5,535.4531,2052.5,539.4531,2042.5,543.4531,2046.5,539.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="2048.5" y1="539.4531" y2="539.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="339" x="1182.5" y="534.3872">Xs2aListAccountsEntrypoint.execute(ServiceContext)</text><polygon fill="#A80036" points="1293.5,564.5859,1283.5,568.5859,1293.5,572.5859,1289.5,568.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1287.5" x2="2053.5" y1="568.5859" y2="568.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="1299.5" y="563.52">Consent for service session</text><polygon fill="#A80036" points="2042.5,593.7188,2052.5,597.7188,2042.5,601.7188,2046.5,597.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1282.5" x2="2048.5" y1="597.7188" y2="597.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1289.5" y="592.6528">Consent present,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="1403.5" y="592.6528">consent context</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2829.5" x2="2871.5" y1="641.9844" y2="641.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2871.5" x2="2871.5" y1="641.9844" y2="654.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2830.5" x2="2871.5" y1="654.9844" y2="654.9844"/><polygon fill="#A80036" points="2840.5,650.9844,2830.5,654.9844,2840.5,658.9844,2836.5,654.9844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="2836.5" y="621.7856">Validate</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="2892.5" y="621.7856">consent context</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="3014.5" y="621.7856">-</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="2836.5" y="636.9185">do we have enough data (Mocked execution)</text><polygon fill="#A80036" points="3220,680.1172,3230,684.1172,3220,688.1172,3224,684.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2829.5" x2="3226" y1="684.1172" y2="684.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="2836.5" y="679.0513">Call ASPSP with consent using</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="3032.5" y="679.0513">consent context</text><polygon fill="#A80036" points="2840.5,709.25,2830.5,713.25,2840.5,717.25,2836.5,713.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2834.5" x2="3231" y1="713.25" y2="713.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="2846.5" y="708.1841">Users' accounts</text><polygon fill="#A80036" points="3117.5,738.3828,3127.5,742.3828,3117.5,746.3828,3121.5,742.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2829.5" x2="3123.5" y1="742.3828" y2="742.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="2836.5" y="737.3169">Translate ASPSP response</text><polygon fill="#A80036" points="2677.5,767.5156,2667.5,771.5156,2677.5,775.5156,2673.5,771.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2671.5" x2="3128.5" y1="771.5156" y2="771.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="2683.5" y="766.4497">Translate ASPSP response</text><polygon fill="#A80036" points="3117.5,796.6484,3127.5,800.6484,3117.5,804.6484,3121.5,800.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2666.5" x2="3123.5" y1="800.6484" y2="800.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="2673.5" y="795.5825">Account list</text><polygon fill="#A80036" points="2065.5,810.6484,2055.5,814.6484,2065.5,818.6484,2061.5,814.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2059.5" x2="3128.5" y1="814.6484" y2="814.6484"/><polygon fill="#A80036" points="1186.5,839.7813,1176.5,843.7813,1186.5,847.7813,1182.5,843.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="2053.5" y1="843.7813" y2="843.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="1192.5" y="838.7153">SuccessResult&lt;Account list&gt;</text><polygon fill="#A80036" points="1186.5,868.9141,1176.5,872.9141,1186.5,876.9141,1182.5,872.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="2465.5" y1="872.9141" y2="872.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="1192.5" y="867.8481">SuccessResult&lt;Account list&gt;</text><polygon fill="#A80036" points="1841.5,898.0469,1851.5,902.0469,1841.5,906.0469,1845.5,902.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1847.5" y1="902.0469" y2="902.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="1182.5" y="896.981">Translate SuccessResult -&gt; FacadeSuccessResult</text><polygon fill="#A80036" points="624,927.1797,614,931.1797,624,935.1797,620,931.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="618" x2="1852.5" y1="931.1797" y2="931.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="630" y="926.1138">process FacadeSuccessResult</text><polygon fill="#A80036" points="997,956.3125,1007,960.3125,997,964.3125,1001,960.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="613" x2="1003" y1="960.3125" y2="960.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="620" y="955.2466">translate FacadeSuccessResult</text><polygon fill="#A80036" points="624,985.4453,614,989.4453,624,993.4453,620,989.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="618" x2="1008" y1="989.4453" y2="989.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="630" y="984.3794">This is 200 code with Account list body</text><polygon fill="#A80036" points="460.5,1014.5781,450.5,1018.5781,460.5,1022.5781,456.5,1018.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="454.5" x2="612" y1="1018.5781" y2="1018.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="466.5" y="1013.5122">200 and Account list</text><polygon fill="#A80036" points="49.5,1043.7109,39.5,1047.7109,49.5,1051.7109,45.5,1047.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="43.5" x2="448.5" y1="1047.7109" y2="1047.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="55.5" y="1042.645">200 and Account list</text><rect fill="#DDDDDD" height="26.2969" rx="5" ry="5" style="stroke: #000000; stroke-width: 1.0;" width="374" x="11" y="11"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="362" x="17" y="28.9951">Reading account list when consent is present</text><!--MD5=[a4f72ae954df3612ab44f1ff7cf0ca7e]
@startuml
legend top left
  <b>Reading account list when consent is present</b>
endlegend

actor FinTech

collections TppBackend

box "TPP API"
control TppBankingApiAisController
control ConsentServiceController
participant FacadeResponseMapper
endbox

box "OPBA-Facade"
collections FacadeService
database Database
participant ServiceContextProvider
participant ProtocolSelector
participant Spring
participant ProtocolResultHandler
endbox

box "XS2A-Protocol"
participant Xs2aListAccountsEntrypoint
participant Xs2aUpdateAuthorization
participant Xs2aFromAspspRedirect
participant Xs2aResultBodyExtractor
collections Xs2aServices
participant OutcomeMapper
endbox

boundary ASPSP

== Fintech calls user account list within same session id ==

FinTech -> TppBackend : GET /accounts\n with <b>service session id</b> and Fintech user info, bank id, etc.
TppBackend -> TppBankingApiAisController : getAccounts
TppBankingApiAisController -> FacadeService : Facade.execute()
FacadeService -> ServiceContextProvider : Create facade context from request
FacadeService <- ServiceContextProvider : ServiceContext
FacadeService -> ProtocolSelector : Select bank protocol from request type and bank id
ProtocolSelector -> Database : Read bank protocol using bank uuid and action id
Database -> ProtocolSelector : BankProtocol
ProtocolSelector -> FacadeService : BankProtocol
FacadeService -> Spring : Find bean - Bean(BankProtocol.protocolBeanName) extends Action
FacadeService <- Spring : It is Xs2aListAccountsEntrypoint service bean
FacadeService -> Xs2aListAccountsEntrypoint : Xs2aListAccountsEntrypoint.execute(ServiceContext)
Xs2aListAccountsEntrypoint -> Database : Consent for service session
Xs2aListAccountsEntrypoint <- Database : Consent present, <b>consent context</b>
Xs2aServices -> Xs2aServices : Validate <b>consent context</b> -\ndo we have enough data (Mocked execution)
Xs2aServices -> ASPSP : Call ASPSP with consent using <b>consent context</b>
ASPSP -> Xs2aServices : Users' accounts
Xs2aServices -> OutcomeMapper : Translate ASPSP response
OutcomeMapper -> Xs2aResultBodyExtractor : Translate ASPSP response
Xs2aResultBodyExtractor -> OutcomeMapper : Account list
OutcomeMapper -> Xs2aListAccountsEntrypoint
Xs2aListAccountsEntrypoint -> FacadeService : SuccessResult<Account list>
Xs2aFromAspspRedirect -> FacadeService : SuccessResult<Account list>
FacadeService -> ProtocolResultHandler : Translate SuccessResult -> FacadeSuccessResult
ProtocolResultHandler -> TppBankingApiAisController : process FacadeSuccessResult
TppBankingApiAisController -> FacadeResponseMapper : translate FacadeSuccessResult
FacadeResponseMapper -> TppBankingApiAisController : This is 200 code with Account list body
TppBankingApiAisController -> TppBackend : 200 and Account list
TppBackend -> FinTech : 200 and Account list
@enduml

PlantUML version 1.2019.11(Sun Sep 22 13:02:15 EEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_232-release-1638-b6
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>