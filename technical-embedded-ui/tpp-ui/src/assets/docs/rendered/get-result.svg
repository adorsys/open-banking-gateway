<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1104px" preserveAspectRatio="none" style="width:3248px;height:1104px;" version="1.1" viewBox="0 0 3248 1104" width="3248px" zoomAndPan="magnify"><defs><filter height="300%" id="fgebtl1oot8af" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1046.4453" style="stroke: #A80036; stroke-width: 1.0;" width="598" x="510.5" y="47.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="781" y="59.3638">TPP API</text><rect fill="#DDDDDD" height="1046.4453" style="stroke: #A80036; stroke-width: 1.0;" width="807" x="1110.5" y="47.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="1464" y="59.3638">OPBA-Facade</text><rect fill="#DDDDDD" height="1046.4453" style="stroke: #A80036; stroke-width: 1.0;" width="1255" x="1919.5" y="47.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="2495" y="59.3638">XS2A-Protocol</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="38" x2="38" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="449.5" x2="449.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="612.5" x2="612.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="812.5" x2="812.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1008.5" x2="1008.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1175.5" x2="1175.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1282.5" x2="1282.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1428.5" x2="1428.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1593.5" x2="1593.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1700.5" x2="1700.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1827.5" x2="1827.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2028.5" x2="2028.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2239.5" x2="2239.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2440.5" x2="2440.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2640.5" x2="2640.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2803.5" x2="2803.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3103.5" x2="3103.5" y1="129.5938" y2="1007.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3205.5" x2="3205.5" y1="129.5938" y2="1007.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="8" y="126.292">FinTech</text><ellipse cx="38.5" cy="56.2969" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M38.5,64.2969 L38.5,91.2969 M25.5,72.2969 L51.5,72.2969 M38.5,91.2969 L25.5,106.2969 M38.5,91.2969 L51.5,106.2969 " fill="none" filter="url(#fgebtl1oot8af)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="8" y="1019.4404">FinTech</text><ellipse cx="38.5" cy="1032.7422" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M38.5,1040.7422 L38.5,1067.7422 M25.5,1048.7422 L51.5,1048.7422 M38.5,1067.7422 L25.5,1082.7422 M38.5,1067.7422 L51.5,1082.7422 " fill="none" filter="url(#fgebtl1oot8af)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="398.5" y="90.2969"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="394.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="401.5" y="114.292">TppBackend</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="398.5" y="1006.4453"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="102" x="394.5" y="1010.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="401.5" y="1030.4404">TppBackend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="191" x="514.5" y="126.292">TppBankingApiAisController</text><ellipse cx="613" cy="97.2969" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="609,85.2969,615,80.2969,613,85.2969,615,90.2969,609,85.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="191" x="514.5" y="1019.4404">TppBankingApiAisController</text><ellipse cx="613" cy="1038.7422" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="609,1026.7422,615,1021.7422,613,1026.7422,615,1031.7422,609,1026.7422" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="176" x="721.5" y="126.292">ConsentServiceController</text><ellipse cx="812.5" cy="97.2969" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="808.5,85.2969,814.5,80.2969,812.5,85.2969,814.5,90.2969,808.5,85.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="176" x="721.5" y="1019.4404">ConsentServiceController</text><ellipse cx="812.5" cy="1038.7422" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="808.5,1026.7422,814.5,1021.7422,812.5,1026.7422,814.5,1031.7422,808.5,1026.7422" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="913.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="920.5" y="114.292">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="913.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="920.5" y="1026.4404">FacadeResponseMapper</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1118.5" y="90.2969"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1114.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1121.5" y="114.292">FacadeService</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1118.5" y="1006.4453"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1114.5" y="1010.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1121.5" y="1030.4404">FacadeService</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="1246.5" y="126.292">Database</text><path d="M1264.5,77.2969 C1264.5,67.2969 1282.5,67.2969 1282.5,67.2969 C1282.5,67.2969 1300.5,67.2969 1300.5,77.2969 L1300.5,103.2969 C1300.5,113.2969 1282.5,113.2969 1282.5,113.2969 C1282.5,113.2969 1264.5,113.2969 1264.5,103.2969 L1264.5,77.2969 " fill="#FEFECE" filter="url(#fgebtl1oot8af)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1264.5,77.2969 C1264.5,87.2969 1282.5,87.2969 1282.5,87.2969 C1282.5,87.2969 1300.5,87.2969 1300.5,77.2969 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="1246.5" y="1019.4404">Database</text><path d="M1264.5,1032.7422 C1264.5,1022.7422 1282.5,1022.7422 1282.5,1022.7422 C1282.5,1022.7422 1300.5,1022.7422 1300.5,1032.7422 L1300.5,1058.7422 C1300.5,1068.7422 1282.5,1068.7422 1282.5,1068.7422 C1282.5,1068.7422 1264.5,1068.7422 1264.5,1058.7422 L1264.5,1032.7422 " fill="#FEFECE" filter="url(#fgebtl1oot8af)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1264.5,1032.7422 C1264.5,1042.7422 1282.5,1042.7422 1282.5,1042.7422 C1282.5,1042.7422 1300.5,1042.7422 1300.5,1032.7422 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="174" x="1339.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="1346.5" y="114.292">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="174" x="1339.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="1346.5" y="1026.4404">ServiceContextProvider</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="1527.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1534.5" y="114.292">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="1527.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1534.5" y="1026.4404">ProtocolSelector</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="1669.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="1676.5" y="114.292">Spring</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="1669.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="1676.5" y="1026.4404">Spring</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="1741.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="1748.5" y="114.292">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="1741.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="1748.5" y="1026.4404">ProtocolResultHandler</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="1923.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="1930.5" y="114.292">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="1923.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="1930.5" y="1026.4404">Xs2aListAccountsEntrypoint</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="189" x="2143.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="2150.5" y="114.292">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="189" x="2143.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="2150.5" y="1026.4404">Xs2aUpdateAuthorization</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="2346.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="2353.5" y="114.292">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="2346.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="2353.5" y="1026.4404">Xs2aFromAspspRedirect</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="2544.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="174" x="2551.5" y="114.292">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="2544.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="174" x="2551.5" y="1026.4404">Xs2aResultBodyExtractor</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2750.5" y="90.2969"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2746.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="2753.5" y="114.292">Xs2aServices</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2750.5" y="1006.4453"/><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="2746.5" y="1010.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="2753.5" y="1030.4404">Xs2aServices</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="3036.5" y="94.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="3043.5" y="114.292">OutcomeMapper</text><rect fill="#FEFECE" filter="url(#fgebtl1oot8af)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="3036.5" y="1006.4453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="3043.5" y="1026.4404">OutcomeMapper</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="3180.5" y="126.292">ASPSP</text><path d="M3185.5,85.2969 L3185.5,109.2969 M3185.5,97.2969 L3202.5,97.2969 " fill="none" filter="url(#fgebtl1oot8af)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3214.5" cy="97.2969" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="3180.5" y="1019.4404">ASPSP</text><path d="M3185.5,1026.7422 L3185.5,1050.7422 M3185.5,1038.7422 L3202.5,1038.7422 " fill="none" filter="url(#fgebtl1oot8af)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="3214.5" cy="1038.7422" fill="#FEFECE" filter="url(#fgebtl1oot8af)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#EEEEEE" filter="url(#fgebtl1oot8af)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="3233.5" x="3" y="160.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3236.5" y1="160.1602" y2="160.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3236.5" y1="163.1602" y2="163.1602"/><rect fill="#EEEEEE" filter="url(#fgebtl1oot8af)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="411" x="1414.25" y="149.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="392" x="1420.25" y="165.6606">Fintech calls user account list within same session id</text><polygon fill="#A80036" points="437.5,214.9922,447.5,218.9922,437.5,222.9922,441.5,218.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="38.5" x2="443.5" y1="218.9922" y2="218.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="45.5" y="198.7935">GET /accounts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="49.5" y="213.9263">with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="78.5" y="213.9263">service session id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="213.5" y="213.9263">and Fintech user info, bank id, etc.</text><polygon fill="#A80036" points="601,244.125,611,248.125,601,252.125,605,248.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449.5" x2="607" y1="248.125" y2="248.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="456.5" y="243.0591">getAccounts</text><polygon fill="#A80036" points="1163.5,273.2578,1173.5,277.2578,1163.5,281.2578,1167.5,277.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="613" x2="1169.5" y1="277.2578" y2="277.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="620" y="272.1919">Facade.execute()</text><polygon fill="#A80036" points="1416.5,302.3906,1426.5,306.3906,1416.5,310.3906,1420.5,306.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1422.5" y1="306.3906" y2="306.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="1182.5" y="301.3247">Create facade context from request</text><polygon fill="#A80036" points="1186.5,331.5234,1176.5,335.5234,1186.5,339.5234,1182.5,335.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="1427.5" y1="335.5234" y2="335.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="1192.5" y="330.4575">ServiceContext</text><polygon fill="#A80036" points="1581.5,360.6563,1591.5,364.6563,1581.5,368.6563,1585.5,364.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1587.5" y1="364.6563" y2="364.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="328" x="1182.5" y="359.5903">Select bank protocol from request type and bank id</text><polygon fill="#A80036" points="1186.5,389.7891,1176.5,393.7891,1186.5,397.7891,1182.5,393.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="1592.5" y1="393.7891" y2="393.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="1192.5" y="388.7231">BankProtocol</text><polygon fill="#A80036" points="1688.5,418.9219,1698.5,422.9219,1688.5,426.9219,1692.5,422.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1694.5" y1="422.9219" y2="422.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="429" x="1182.5" y="417.856">Find bean - Bean(BankProtocol.protocolBeanName) extends Action</text><polygon fill="#A80036" points="1186.5,448.0547,1176.5,452.0547,1186.5,456.0547,1182.5,452.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="1699.5" y1="452.0547" y2="452.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="1192.5" y="446.9888">It is Xs2aListAccountsEntrypoint service bean</text><polygon fill="#A80036" points="2016.5,477.1875,2026.5,481.1875,2016.5,485.1875,2020.5,481.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="2022.5" y1="481.1875" y2="481.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="339" x="1182.5" y="476.1216">Xs2aListAccountsEntrypoint.execute(ServiceContext)</text><polygon fill="#A80036" points="1293.5,506.3203,1283.5,510.3203,1293.5,514.3203,1289.5,510.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1287.5" x2="2027.5" y1="510.3203" y2="510.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="1299.5" y="505.2544">Consent for service session</text><polygon fill="#A80036" points="2016.5,535.4531,2026.5,539.4531,2016.5,543.4531,2020.5,539.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1282.5" x2="2022.5" y1="539.4531" y2="539.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1289.5" y="534.3872">Consent present,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="1403.5" y="534.3872">consent context</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2803.5" x2="2845.5" y1="583.7188" y2="583.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2845.5" x2="2845.5" y1="583.7188" y2="596.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2804.5" x2="2845.5" y1="596.7188" y2="596.7188"/><polygon fill="#A80036" points="2814.5,592.7188,2804.5,596.7188,2814.5,600.7188,2810.5,596.7188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="2810.5" y="563.52">Validate</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="2866.5" y="563.52">consent context</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="2988.5" y="563.52">-</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="2810.5" y="578.6528">do we have enough data (Mocked execution)</text><polygon fill="#A80036" points="3194,621.8516,3204,625.8516,3194,629.8516,3198,625.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2803.5" x2="3200" y1="625.8516" y2="625.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="2810.5" y="620.7856">Call ASPSP with consent using</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="3006.5" y="620.7856">consent context</text><polygon fill="#A80036" points="2814.5,650.9844,2804.5,654.9844,2814.5,658.9844,2810.5,654.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2808.5" x2="3205" y1="654.9844" y2="654.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="2820.5" y="649.9185">Users' accounts</text><polygon fill="#A80036" points="3091.5,680.1172,3101.5,684.1172,3091.5,688.1172,3095.5,684.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2803.5" x2="3097.5" y1="684.1172" y2="684.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="2810.5" y="679.0513">Translate ASPSP response</text><polygon fill="#A80036" points="2651.5,709.25,2641.5,713.25,2651.5,717.25,2647.5,713.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2645.5" x2="3102.5" y1="713.25" y2="713.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="2657.5" y="708.1841">Translate ASPSP response</text><polygon fill="#A80036" points="3091.5,738.3828,3101.5,742.3828,3091.5,746.3828,3095.5,742.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2640.5" x2="3097.5" y1="742.3828" y2="742.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="2647.5" y="737.3169">Account list</text><polygon fill="#A80036" points="2039.5,752.3828,2029.5,756.3828,2039.5,760.3828,2035.5,756.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2033.5" x2="3102.5" y1="756.3828" y2="756.3828"/><polygon fill="#A80036" points="1186.5,781.5156,1176.5,785.5156,1186.5,789.5156,1182.5,785.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="2027.5" y1="785.5156" y2="785.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="1192.5" y="780.4497">SuccessResult&lt;Account list&gt;</text><polygon fill="#A80036" points="1186.5,810.6484,1176.5,814.6484,1186.5,818.6484,1182.5,814.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180.5" x2="2439.5" y1="814.6484" y2="814.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="1192.5" y="809.5825">SuccessResult&lt;Account list&gt;</text><polygon fill="#A80036" points="1815.5,839.7813,1825.5,843.7813,1815.5,847.7813,1819.5,843.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1175.5" x2="1821.5" y1="843.7813" y2="843.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="1182.5" y="838.7153">Translate SuccessResult -&gt; FacadeSuccessResult</text><polygon fill="#A80036" points="624,868.9141,614,872.9141,624,876.9141,620,872.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="618" x2="1826.5" y1="872.9141" y2="872.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="630" y="867.8481">process FacadeSuccessResult</text><polygon fill="#A80036" points="997,898.0469,1007,902.0469,997,906.0469,1001,902.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="613" x2="1003" y1="902.0469" y2="902.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="620" y="896.981">translate FacadeSuccessResult</text><polygon fill="#A80036" points="624,927.1797,614,931.1797,624,935.1797,620,931.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="618" x2="1008" y1="931.1797" y2="931.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="630" y="926.1138">This is 200 code with Account list body</text><polygon fill="#A80036" points="460.5,956.3125,450.5,960.3125,460.5,964.3125,456.5,960.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="454.5" x2="612" y1="960.3125" y2="960.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="466.5" y="955.2466">200 and Account list</text><polygon fill="#A80036" points="49.5,985.4453,39.5,989.4453,49.5,993.4453,45.5,989.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="43.5" x2="448.5" y1="989.4453" y2="989.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="55.5" y="984.3794">200 and Account list</text><rect fill="#DDDDDD" height="26.2969" rx="5" ry="5" style="stroke: #000000; stroke-width: 1.0;" width="374" x="11" y="11"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="362" x="17" y="28.9951">Reading account list when consent is present</text><!--MD5=[3a3f4c77863251cd71b8aeb651606ff3]
@startuml
legend top left
  <b>Reading account list when consent is present</b>
endlegend

actor FinTech

collections TppBackend

box "TPP API"
control TppBankingApiAisController
control ConsentServiceController
participant FacadeResponseMapper
endbox

box "OPBA-Facade"
collections FacadeService
database Database
participant ServiceContextProvider
participant ProtocolSelector
participant Spring
participant ProtocolResultHandler
endbox

box "XS2A-Protocol"
participant Xs2aListAccountsEntrypoint
participant Xs2aUpdateAuthorization
participant Xs2aFromAspspRedirect
participant Xs2aResultBodyExtractor
collections Xs2aServices
participant OutcomeMapper
endbox

boundary ASPSP

== Fintech calls user account list within same session id ==

FinTech -> TppBackend : GET /accounts\n with <b>service session id</b> and Fintech user info, bank id, etc.
TppBackend -> TppBankingApiAisController : getAccounts
TppBankingApiAisController -> FacadeService : Facade.execute()
FacadeService -> ServiceContextProvider : Create facade context from request
FacadeService <- ServiceContextProvider : ServiceContext
FacadeService -> ProtocolSelector : Select bank protocol from request type and bank id
ProtocolSelector -> FacadeService : BankProtocol
FacadeService -> Spring : Find bean - Bean(BankProtocol.protocolBeanName) extends Action
FacadeService <- Spring : It is Xs2aListAccountsEntrypoint service bean
FacadeService -> Xs2aListAccountsEntrypoint : Xs2aListAccountsEntrypoint.execute(ServiceContext)
Xs2aListAccountsEntrypoint -> Database : Consent for service session
Xs2aListAccountsEntrypoint <- Database : Consent present, <b>consent context</b>
Xs2aServices -> Xs2aServices : Validate <b>consent context</b> -\ndo we have enough data (Mocked execution)
Xs2aServices -> ASPSP : Call ASPSP with consent using <b>consent context</b>
ASPSP -> Xs2aServices : Users' accounts
Xs2aServices -> OutcomeMapper : Translate ASPSP response
OutcomeMapper -> Xs2aResultBodyExtractor : Translate ASPSP response
Xs2aResultBodyExtractor -> OutcomeMapper : Account list
OutcomeMapper -> Xs2aListAccountsEntrypoint
Xs2aListAccountsEntrypoint -> FacadeService : SuccessResult<Account list>
Xs2aFromAspspRedirect -> FacadeService : SuccessResult<Account list>
FacadeService -> ProtocolResultHandler : Translate SuccessResult -> FacadeSuccessResult
ProtocolResultHandler -> TppBankingApiAisController : process FacadeSuccessResult
TppBankingApiAisController -> FacadeResponseMapper : translate FacadeSuccessResult
FacadeResponseMapper -> TppBankingApiAisController : This is 200 code with Account list body
TppBankingApiAisController -> TppBackend : 200 and Account list
TppBackend -> FinTech : 200 and Account list
@enduml

PlantUML version 1.2019.11(Sun Sep 22 13:02:15 EEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_232-release-1638-b6
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
